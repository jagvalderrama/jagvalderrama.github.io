/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t={272:(t,e,n)=>{"use strict";var i=n(723),r=[],s=[],o=i.makeRequestCallFromTimer((function(){if(s.length)throw s.shift()}));function a(t){var e;(e=r.length?r.pop():new l).task=t,i(e)}function l(){this.task=null}t.exports=a,l.prototype.call=function(){try{this.task.call()}catch(t){a.onerror?a.onerror(t):(s.push(t),o())}finally{this.task=null,r[r.length]=this}}},723:(t,e,n)=>{"use strict";function i(t){s.length||(r(),!0),s[s.length]=t}t.exports=i;var r,s=[],o=0;function a(){for(;o<s.length;){var t=o;if(o+=1,s[t].call(),o>1024){for(var e=0,n=s.length-o;e<n;e++)s[e]=s[e+o];s.length-=o,o=0}}s.length=0,o=0,!1}var l,c,u,h=void 0!==n.g?n.g:self,d=h.MutationObserver||h.WebKitMutationObserver;function p(t){return function(){var e=setTimeout(i,0),n=setInterval(i,50);function i(){clearTimeout(e),clearInterval(n),t()}}}"function"==typeof d?(l=1,c=new d(a),u=document.createTextNode(""),c.observe(u,{characterData:!0}),r=function(){l=-l,u.data=l}):r=p(a),i.requestFlush=r,i.makeRequestCallFromTimer=p},560:function(t,e,n){var i;!function(r){"use strict";function s(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function o(t,e,n,i,r,o){return s((a=s(s(e,t),s(i,o)))<<(l=r)|a>>>32-l,n);var a,l}function a(t,e,n,i,r,s,a){return o(e&n|~e&i,t,e,r,s,a)}function l(t,e,n,i,r,s,a){return o(e&i|n&~i,t,e,r,s,a)}function c(t,e,n,i,r,s,a){return o(e^n^i,t,e,r,s,a)}function u(t,e,n,i,r,s,a){return o(n^(e|~i),t,e,r,s,a)}function h(t,e){var n,i,r,o,h;t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var d=1732584193,p=-271733879,f=-1732584194,m=271733878;for(n=0;n<t.length;n+=16)i=d,r=p,o=f,h=m,d=a(d,p,f,m,t[n],7,-680876936),m=a(m,d,p,f,t[n+1],12,-389564586),f=a(f,m,d,p,t[n+2],17,606105819),p=a(p,f,m,d,t[n+3],22,-1044525330),d=a(d,p,f,m,t[n+4],7,-176418897),m=a(m,d,p,f,t[n+5],12,1200080426),f=a(f,m,d,p,t[n+6],17,-1473231341),p=a(p,f,m,d,t[n+7],22,-45705983),d=a(d,p,f,m,t[n+8],7,1770035416),m=a(m,d,p,f,t[n+9],12,-1958414417),f=a(f,m,d,p,t[n+10],17,-42063),p=a(p,f,m,d,t[n+11],22,-1990404162),d=a(d,p,f,m,t[n+12],7,1804603682),m=a(m,d,p,f,t[n+13],12,-40341101),f=a(f,m,d,p,t[n+14],17,-1502002290),d=l(d,p=a(p,f,m,d,t[n+15],22,1236535329),f,m,t[n+1],5,-165796510),m=l(m,d,p,f,t[n+6],9,-1069501632),f=l(f,m,d,p,t[n+11],14,643717713),p=l(p,f,m,d,t[n],20,-373897302),d=l(d,p,f,m,t[n+5],5,-701558691),m=l(m,d,p,f,t[n+10],9,38016083),f=l(f,m,d,p,t[n+15],14,-660478335),p=l(p,f,m,d,t[n+4],20,-405537848),d=l(d,p,f,m,t[n+9],5,568446438),m=l(m,d,p,f,t[n+14],9,-1019803690),f=l(f,m,d,p,t[n+3],14,-187363961),p=l(p,f,m,d,t[n+8],20,1163531501),d=l(d,p,f,m,t[n+13],5,-1444681467),m=l(m,d,p,f,t[n+2],9,-51403784),f=l(f,m,d,p,t[n+7],14,1735328473),d=c(d,p=l(p,f,m,d,t[n+12],20,-1926607734),f,m,t[n+5],4,-378558),m=c(m,d,p,f,t[n+8],11,-2022574463),f=c(f,m,d,p,t[n+11],16,1839030562),p=c(p,f,m,d,t[n+14],23,-35309556),d=c(d,p,f,m,t[n+1],4,-1530992060),m=c(m,d,p,f,t[n+4],11,1272893353),f=c(f,m,d,p,t[n+7],16,-155497632),p=c(p,f,m,d,t[n+10],23,-1094730640),d=c(d,p,f,m,t[n+13],4,681279174),m=c(m,d,p,f,t[n],11,-358537222),f=c(f,m,d,p,t[n+3],16,-722521979),p=c(p,f,m,d,t[n+6],23,76029189),d=c(d,p,f,m,t[n+9],4,-640364487),m=c(m,d,p,f,t[n+12],11,-421815835),f=c(f,m,d,p,t[n+15],16,530742520),d=u(d,p=c(p,f,m,d,t[n+2],23,-995338651),f,m,t[n],6,-198630844),m=u(m,d,p,f,t[n+7],10,1126891415),f=u(f,m,d,p,t[n+14],15,-1416354905),p=u(p,f,m,d,t[n+5],21,-57434055),d=u(d,p,f,m,t[n+12],6,1700485571),m=u(m,d,p,f,t[n+3],10,-1894986606),f=u(f,m,d,p,t[n+10],15,-1051523),p=u(p,f,m,d,t[n+1],21,-2054922799),d=u(d,p,f,m,t[n+8],6,1873313359),m=u(m,d,p,f,t[n+15],10,-30611744),f=u(f,m,d,p,t[n+6],15,-1560198380),p=u(p,f,m,d,t[n+13],21,1309151649),d=u(d,p,f,m,t[n+4],6,-145523070),m=u(m,d,p,f,t[n+11],10,-1120210379),f=u(f,m,d,p,t[n+2],15,718787259),p=u(p,f,m,d,t[n+9],21,-343485551),d=s(d,i),p=s(p,r),f=s(f,o),m=s(m,h);return[d,p,f,m]}function d(t){var e,n="",i=32*t.length;for(e=0;e<i;e+=8)n+=String.fromCharCode(t[e>>5]>>>e%32&255);return n}function p(t){var e,n=[];for(n[(t.length>>2)-1]=void 0,e=0;e<n.length;e+=1)n[e]=0;var i=8*t.length;for(e=0;e<i;e+=8)n[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return n}function f(t){var e,n,i="";for(n=0;n<t.length;n+=1)e=t.charCodeAt(n),i+="0123456789abcdef".charAt(e>>>4&15)+"0123456789abcdef".charAt(15&e);return i}function m(t){return unescape(encodeURIComponent(t))}function g(t){return function(t){return d(h(p(t),8*t.length))}(m(t))}function v(t,e){return function(t,e){var n,i,r=p(t),s=[],o=[];for(s[15]=o[15]=void 0,r.length>16&&(r=h(r,8*t.length)),n=0;n<16;n+=1)s[n]=909522486^r[n],o[n]=1549556828^r[n];return i=h(s.concat(p(e)),512+8*e.length),d(h(o.concat(i),640))}(m(t),m(e))}function y(t,e,n){return e?n?v(e,t):f(v(e,t)):n?g(t):f(g(t))}void 0===(i=function(){return y}.call(e,n,e,t))||(t.exports=i)}()},965:(t,e,n)=>{"use strict";var i=n(742),r=n(782),s={VERSION:i.VERSION,Client:n(955),Scheduler:n(148)};r.wrapper=s,t.exports=s},890:(t,e,n)=>{"use strict";var i=n(857);t.exports={then:function(t,e){var n=this;return this._promise||(this._promise=new i((function(t,e){n._resolve=t,n._reject=e}))),0===arguments.length?this._promise:this._promise.then(t,e)},callback:function(t,e){return this.then((function(n){t.call(e,n)}))},errback:function(t,e){return this.then(null,(function(n){t.call(e,n)}))},timeout:function(t,e){this.then();var i=this;this._timer=n.g.setTimeout((function(){i._reject(e)}),1e3*t)},setDeferredStatus:function(t,e){this._timer&&n.g.clearTimeout(this._timer),this.then(),"succeeded"===t?this._resolve(e):"failed"===t?this._reject(e):delete this._promise}}},782:(t,e,n)=>{"use strict";var i=n(457),r={LOG_LEVELS:{fatal:4,error:3,warn:2,info:1,debug:0},writeLog:function(t,e){var n=r.logger||(r.wrapper||r).logger;if(n){var s=Array.prototype.slice.apply(t),o="[Faye",a=this.className,l=s.shift().replace(/\?/g,(function(){try{return i(s.shift())}catch(t){return"[Object]"}}));a&&(o+="."+a),o+="] ","function"==typeof n[e]?n[e](o+l):"function"==typeof n&&n(o+l)}}};for(var s in r.LOG_LEVELS)!function(t){r[t]=function(){this.writeLog(arguments,t)}}(s);t.exports=r},909:(t,e,n)=>{"use strict";var i={countListeners:function(t){return this.listeners(t).length},bind:function(t,e,n){var i=Array.prototype.slice,r=function(){e.apply(n,i.call(arguments))};return this._listeners=this._listeners||[],this._listeners.push([t,e,n,r]),this.on(t,r)},unbind:function(t,e,n){this._listeners=this._listeners||[];for(var i,r=this._listeners.length;r--;)(i=this._listeners[r])[0]===t&&(!e||i[1]===e&&i[2]===n)&&(this._listeners.splice(r,1),this.removeListener(t,i[3]))}};n(88)(i,n(356).prototype),i.trigger=i.emit,t.exports=i},840:(t,e,n)=>{"use strict";t.exports={addTimeout:function(t,e,i,r){if(this._timeouts=this._timeouts||{},!this._timeouts.hasOwnProperty(t)){var s=this;this._timeouts[t]=n.g.setTimeout((function(){delete s._timeouts[t],i.call(r)}),1e3*e)}},removeTimeout:function(t){this._timeouts=this._timeouts||{};var e=this._timeouts[t];e&&(n.g.clearTimeout(e),delete this._timeouts[t])},removeAllTimeouts:function(){for(var t in this._timeouts=this._timeouts||{},this._timeouts)this.removeTimeout(t)}}},762:(t,e,n)=>{"use strict";var i=n(702),r=n(88),s=n(909),o=n(710),a=i({initialize:function(t){this.id=this.name=t},push:function(t){this.trigger("message",t)},isUnused:function(){return 0===this.countListeners("message")}});r(a.prototype,s),r(a,{HANDSHAKE:"/meta/handshake",CONNECT:"/meta/connect",SUBSCRIBE:"/meta/subscribe",UNSUBSCRIBE:"/meta/unsubscribe",DISCONNECT:"/meta/disconnect",META:"meta",SERVICE:"service",expand:function(t){var e=this.parse(t),n=["/**",t],i=e.slice();i[i.length-1]="*",n.push(this.unparse(i));for(var r=1,s=e.length;r<s;r++)(i=e.slice(0,r)).push("**"),n.push(this.unparse(i));return n},isValid:function(t){return o.CHANNEL_NAME.test(t)||o.CHANNEL_PATTERN.test(t)},parse:function(t){return this.isValid(t)?t.split("/").slice(1):null},unparse:function(t){return"/"+t.join("/")},isMeta:function(t){var e=this.parse(t);return e?e[0]===this.META:null},isService:function(t){var e=this.parse(t);return e?e[0]===this.SERVICE:null},isSubscribable:function(t){return this.isValid(t)?!this.isMeta(t)&&!this.isService(t):null},Set:i({initialize:function(){this._channels={}},getKeys:function(){var t=[];for(var e in this._channels)t.push(e);return t},remove:function(t){delete this._channels[t]},hasSubscription:function(t){return this._channels.hasOwnProperty(t)},subscribe:function(t,e){for(var n,i=0,r=t.length;i<r;i++){n=t[i],(this._channels[n]=this._channels[n]||new a(n)).bind("message",e)}},unsubscribe:function(t,e){var n=this._channels[t];return!!n&&(n.unbind("message",e),!!n.isUnused()&&(this.remove(t),!0))},distributeMessage:function(t){for(var e=a.expand(t.channel),n=0,i=e.length;n<i;n++){var r=this._channels[e[n]];r&&r.trigger("message",t)}}})}),t.exports=a},955:(t,e,n)=>{"use strict";var i=n(272),r=n(702),s=(n(857),n(722)),o=n(375),a=n(742),l=n(88),c=n(978),u=n(890),h=n(782),d=n(909),p=n(762),f=n(854),m=n(656),g=n(983),v=n(347),y=n(740),_=r({className:"Client",UNCONNECTED:1,CONNECTING:2,CONNECTED:3,DISCONNECTED:4,HANDSHAKE:"handshake",RETRY:"retry",NONE:"none",CONNECTION_TIMEOUT:60,DEFAULT_ENDPOINT:"/bayeux",INTERVAL:0,initialize:function(t,e){this.info("New client created for ?",t),c(e=e||{},["interval","timeout","endpoints","proxy","retry","scheduler","websocketExtensions","tls","ca"]),this._channels=new p.Set,this._dispatcher=f.create(this,t||this.DEFAULT_ENDPOINT,e),this._messageId=0,this._state=this.UNCONNECTED,this._responseCallbacks={},this._advice={reconnect:this.RETRY,interval:1e3*(e.interval||this.INTERVAL),timeout:1e3*(e.timeout||this.CONNECTION_TIMEOUT)},this._dispatcher.timeout=this._advice.timeout/1e3,this._dispatcher.bind("message",this._receiveMessage,this),o.Event&&void 0!==n.g.onbeforeunload&&o.Event.on(n.g,"beforeunload",(function(){s.indexOf(this._dispatcher._disabled,"autodisconnect")<0&&this.disconnect()}),this)},addWebsocketExtension:function(t){return this._dispatcher.addWebsocketExtension(t)},disable:function(t){return this._dispatcher.disable(t)},setHeader:function(t,e){return this._dispatcher.setHeader(t,e)},handshake:function(t,e){if(this._advice.reconnect!==this.NONE&&this._state===this.UNCONNECTED){this._state=this.CONNECTING;var r=this;this.info("Initiating handshake with ?",this._dispatcher.endpoint.href),this._dispatcher.selectTransport(a.MANDATORY_CONNECTION_TYPES),this._sendMessage({channel:p.HANDSHAKE,version:a.BAYEUX_VERSION,supportedConnectionTypes:this._dispatcher.getConnectionTypes()},{},(function(s){s.successful?(this._state=this.CONNECTED,this._dispatcher.clientId=s.clientId,this._dispatcher.selectTransport(s.supportedConnectionTypes),this.info("Handshake successful: ?",this._dispatcher.clientId),this.subscribe(this._channels.getKeys(),!0),t&&i((function(){t.call(e)}))):(this.info("Handshake unsuccessful"),n.g.setTimeout((function(){r.handshake(t,e)}),1e3*this._dispatcher.retry),this._state=this.UNCONNECTED)}),this)}},connect:function(t,e){if(this._advice.reconnect!==this.NONE&&this._state!==this.DISCONNECTED){if(this._state===this.UNCONNECTED)return this.handshake((function(){this.connect(t,e)}),this);this.callback(t,e),this._state===this.CONNECTED&&(this.info("Calling deferred actions for ?",this._dispatcher.clientId),this.setDeferredStatus("succeeded"),this.setDeferredStatus("unknown"),this._connectRequest||(this._connectRequest=!0,this.info("Initiating connection for ?",this._dispatcher.clientId),this._sendMessage({channel:p.CONNECT,clientId:this._dispatcher.clientId,connectionType:this._dispatcher.connectionType},{},this._cycleConnection,this)))}},disconnect:function(){if(this._state===this.CONNECTED){this._state=this.DISCONNECTED,this.info("Disconnecting ?",this._dispatcher.clientId);var t=new v;return this._sendMessage({channel:p.DISCONNECT,clientId:this._dispatcher.clientId},{},(function(e){e.successful?(this._dispatcher.close(),t.setDeferredStatus("succeeded")):t.setDeferredStatus("failed",m.parse(e.error))}),this),this.info("Clearing channel listeners for ?",this._dispatcher.clientId),this._channels=new p.Set,t}},subscribe:function(t,e,n){if(t instanceof Array)return s.map(t,(function(t){return this.subscribe(t,e,n)}),this);var i=new y(this,t,e,n),r=!0===e;return this._channels.hasSubscription(t)&&!r?(this._channels.subscribe([t],i),i.setDeferredStatus("succeeded"),i):(this.connect((function(){this.info("Client ? attempting to subscribe to ?",this._dispatcher.clientId,t),r||this._channels.subscribe([t],i),this._sendMessage({channel:p.SUBSCRIBE,clientId:this._dispatcher.clientId,subscription:t},{},(function(e){if(!e.successful)return i.setDeferredStatus("failed",m.parse(e.error)),this._channels.unsubscribe(t,i);var n=[].concat(e.subscription);this.info("Subscription acknowledged for ? to ?",this._dispatcher.clientId,n),i.setDeferredStatus("succeeded")}),this)}),this),i)},unsubscribe:function(t,e){if(t instanceof Array)return s.map(t,(function(t){return this.unsubscribe(t,e)}),this);this._channels.unsubscribe(t,e)&&this.connect((function(){this.info("Client ? attempting to unsubscribe from ?",this._dispatcher.clientId,t),this._sendMessage({channel:p.UNSUBSCRIBE,clientId:this._dispatcher.clientId,subscription:t},{},(function(t){if(t.successful){var e=[].concat(t.subscription);this.info("Unsubscription acknowledged for ? from ?",this._dispatcher.clientId,e)}}),this)}),this)},publish:function(t,e,n){c(n||{},["attempts","deadline"]);var i=new v;return this.connect((function(){this.info("Client ? queueing published message to ?: ?",this._dispatcher.clientId,t,e),this._sendMessage({channel:t,data:e,clientId:this._dispatcher.clientId},n,(function(t){t.successful?i.setDeferredStatus("succeeded"):i.setDeferredStatus("failed",m.parse(t.error))}),this)}),this),i},_sendMessage:function(t,e,n,i){t.id=this._generateMessageId();var r=this._advice.timeout?1.2*this._advice.timeout/1e3:1.2*this._dispatcher.retry;this.pipeThroughExtensions("outgoing",t,null,(function(t){t&&(n&&(this._responseCallbacks[t.id]=[n,i]),this._dispatcher.sendMessage(t,r,e||{}))}),this)},_generateMessageId:function(){return this._messageId+=1,this._messageId>=Math.pow(2,32)&&(this._messageId=0),this._messageId.toString(36)},_receiveMessage:function(t){var e,n=t.id;void 0!==t.successful&&(e=this._responseCallbacks[n],delete this._responseCallbacks[n]),this.pipeThroughExtensions("incoming",t,null,(function(t){t&&(t.advice&&this._handleAdvice(t.advice),this._deliverMessage(t),e&&e[0].call(e[1],t))}),this)},_handleAdvice:function(t){l(this._advice,t),this._dispatcher.timeout=this._advice.timeout/1e3,this._advice.reconnect===this.HANDSHAKE&&this._state!==this.DISCONNECTED&&(this._state=this.UNCONNECTED,this._dispatcher.clientId=null,this._cycleConnection())},_deliverMessage:function(t){t.channel&&void 0!==t.data&&(this.info("Client ? calling listeners for ? with ?",this._dispatcher.clientId,t.channel,t.data),this._channels.distributeMessage(t))},_cycleConnection:function(){this._connectRequest&&(this._connectRequest=null,this.info("Closed connection for ?",this._dispatcher.clientId));var t=this;n.g.setTimeout((function(){t.connect()}),this._advice.interval)}});l(_.prototype,u),l(_.prototype,d),l(_.prototype,h),l(_.prototype,g),t.exports=_},854:(t,e,n)=>{"use strict";var i=n(702),r=n(655),s=n(754),o=n(88),a=n(782),l=n(909),c=n(713),u=n(148),h=i({className:"Dispatcher",MAX_REQUEST_SIZE:2048,DEFAULT_RETRY:5,UP:1,DOWN:2,initialize:function(t,e,n){this._client=t,this.endpoint=r.parse(e),this._alternates=n.endpoints||{},this.cookies=s.CookieJar&&new s.CookieJar,this._disabled=[],this._envelopes={},this.headers={},this.retry=n.retry||this.DEFAULT_RETRY,this._scheduler=n.scheduler||u,this._state=0,this.transports={},this.wsExtensions=[],this.proxy=n.proxy||{},"string"==typeof this._proxy&&(this._proxy={origin:this._proxy});var i=n.websocketExtensions;if(i)for(var o=0,a=(i=[].concat(i)).length;o<a;o++)this.addWebsocketExtension(i[o]);for(var l in this.tls=n.tls||{},this.tls.ca=this.tls.ca||n.ca,this._alternates)this._alternates[l]=r.parse(this._alternates[l]);this.maxRequestSize=this.MAX_REQUEST_SIZE},endpointFor:function(t){return this._alternates[t]||this.endpoint},addWebsocketExtension:function(t){this.wsExtensions.push(t)},disable:function(t){this._disabled.push(t),c.disable(t)},setHeader:function(t,e){this.headers[t]=e},close:function(){var t=this._transport;delete this._transport,t&&t.close()},getConnectionTypes:function(){return c.getConnectionTypes()},selectTransport:function(t){c.get(this,t,this._disabled,(function(t){this.debug("Selected ? transport for ?",t.connectionType,t.endpoint.href),t!==this._transport&&(this._transport&&this._transport.close(),this._transport=t,this.connectionType=t.connectionType)}),this)},sendMessage:function(t,e,n){n=n||{};var i,r=t.id,s=n.attempts,o=n.deadline&&(new Date).getTime()+1e3*n.deadline,a=this._envelopes[r];a||(i=new this._scheduler(t,{timeout:e,interval:this.retry,attempts:s,deadline:o}),a=this._envelopes[r]={message:t,scheduler:i}),this._sendEnvelope(a)},_sendEnvelope:function(t){if(this._transport&&!t.request&&!t.timer){var e=t.message,i=t.scheduler,r=this;if(!i.isDeliverable())return i.abort(),void delete this._envelopes[e.id];t.timer=n.g.setTimeout((function(){r.handleError(e)}),1e3*i.getTimeout()),i.send(),t.request=this._transport.sendMessage(e)}},handleResponse:function(t){var e=this._envelopes[t.id];void 0!==t.successful&&e&&(e.scheduler.succeed(),delete this._envelopes[t.id],n.g.clearTimeout(e.timer)),this.trigger("message",t),this._state!==this.UP&&(this._state=this.UP,this._client.trigger("transport:up"))},handleError:function(t,e){var i=this._envelopes[t.id],r=i&&i.request,s=this;if(r){r.then((function(t){t&&t.abort&&t.abort()}));var o=i.scheduler;o.fail(),n.g.clearTimeout(i.timer),i.request=i.timer=null,e?this._sendEnvelope(i):i.timer=n.g.setTimeout((function(){i.timer=null,s._sendEnvelope(i)}),1e3*o.getInterval()),this._state!==this.DOWN&&(this._state=this.DOWN,this._client.trigger("transport:down"))}}});h.create=function(t,e,n){return new h(t,e,n)},o(h.prototype,l),o(h.prototype,a),t.exports=h},656:(t,e,n)=>{"use strict";var i=n(702),r=n(710),s=i({initialize:function(t,e,n){this.code=t,this.params=Array.prototype.slice.call(e),this.message=n},toString:function(){return this.code+":"+this.params.join(",")+":"+this.message}});s.parse=function(t){if(t=t||"",!r.ERROR.test(t))return new s(null,[],t);var e=t.split(":"),n=parseInt(e[0]),i=e[1].split(",");t=e[2];return new s(n,i,t)};var o={versionMismatch:[300,"Version mismatch"],conntypeMismatch:[301,"Connection types not supported"],extMismatch:[302,"Extension mismatch"],badRequest:[400,"Bad request"],clientUnknown:[401,"Unknown client"],parameterMissing:[402,"Missing required parameter"],channelForbidden:[403,"Forbidden channel"],channelUnknown:[404,"Unknown channel"],channelInvalid:[405,"Invalid channel"],extUnknown:[406,"Unknown extension"],publishFailed:[407,"Failed to publish"],serverError:[500,"Internal server error"]};for(var a in o)!function(t){s[t]=function(){return new s(o[t][0],arguments,o[t][1]).toString()}}(a);t.exports=s},983:(t,e,n)=>{"use strict";var i={addExtension:function(t){this._extensions=this._extensions||[],this._extensions.push(t),t.added&&t.added(this)},removeExtension:function(t){if(this._extensions)for(var e=this._extensions.length;e--;)this._extensions[e]===t&&(this._extensions.splice(e,1),t.removed&&t.removed(this))},pipeThroughExtensions:function(t,e,n,i,r){if(this.debug("Passing through ? extensions: ?",t,e),!this._extensions)return i.call(r,e);var s=this._extensions.slice(),o=function(e){if(!e)return i.call(r,e);var a=s.shift();if(!a)return i.call(r,e);var l=a[t];if(!l)return o(e);l.length>=3?a[t](e,n,o):a[t](e,o)};o(e)}};n(88)(i,n(782)),t.exports=i},710:t=>{"use strict";t.exports={CHANNEL_NAME:/^\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+(\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+)*$/,CHANNEL_PATTERN:/^(\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+)*\/\*{1,2}$/,ERROR:/^([0-9][0-9][0-9]:(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*(,(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*)*:(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*|[0-9][0-9][0-9]::(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*)$/,VERSION:/^([0-9])+(\.(([a-z]|[A-Z])|[0-9])(((([a-z]|[A-Z])|[0-9])|\-|\_))*)*$/}},347:(t,e,n)=>{"use strict";var i=n(702),r=n(890);t.exports=i(r)},148:(t,e,n)=>{"use strict";var i=function(t,e){this.message=t,this.options=e,this.attempts=0};n(88)(i.prototype,{getTimeout:function(){return this.options.timeout},getInterval:function(){return this.options.interval},isDeliverable:function(){var t=this.options.attempts,e=this.attempts,n=this.options.deadline,i=(new Date).getTime();return!(void 0!==t&&e>=t)&&!(void 0!==n&&i>n)},send:function(){this.attempts+=1},succeed:function(){},fail:function(){},abort:function(){}}),t.exports=i},740:(t,e,n)=>{"use strict";var i=n(702),r=n(88),s=n(890),o=i({initialize:function(t,e,n,i){this._client=t,this._channels=e,this._callback=n,this._context=i,this._cancelled=!1},withChannel:function(t,e){return this._withChannel=[t,e],this},apply:function(t,e){var n=e[0];this._callback&&this._callback.call(this._context,n.data),this._withChannel&&this._withChannel[0].call(this._withChannel[1],n.channel,n.data)},cancel:function(){this._cancelled||(this._client.unsubscribe(this._channels,this),this._cancelled=!0)},unsubscribe:function(){this.cancel()}});r(o.prototype,s),t.exports=o},713:(t,e,n)=>{"use strict";var i=n(195);i.register("websocket",n(182)),i.register("eventsource",n(591)),i.register("long-polling",n(611)),i.register("cross-origin-long-polling",n(45)),i.register("callback-polling",n(881)),t.exports=i},45:(t,e,n)=>{"use strict";var i=n(702),r=n(172),s=n(655),o=n(88),a=n(457),l=o(i(n(195),{encode:function(t){return"message="+encodeURIComponent(a(t))},request:function(t){var e,i=n.g.XDomainRequest?XDomainRequest:XMLHttpRequest,r=new i,s=++l._id,o=this._dispatcher.headers,a=this;if(r.open("POST",this.endpoint.href,!0),r.withCredentials=!0,r.setRequestHeader)for(e in r.setRequestHeader("Pragma","no-cache"),o)o.hasOwnProperty(e)&&r.setRequestHeader(e,o[e]);var c=function(){if(!r)return!1;l._pending.remove(s),r.onload=r.onerror=r.ontimeout=r.onprogress=null,r=null};return r.onload=function(){var e;try{e=JSON.parse(r.responseText)}catch(t){}c(),e?a._receive(e):a._handleError(t)},r.onerror=r.ontimeout=function(){c(),a._handleError(t)},r.onprogress=function(){},i===n.g.XDomainRequest&&l._pending.add({id:s,xhr:r}),r.send(this.encode(t)),r}}),{_id:0,_pending:new r,isUsable:function(t,e,i,r){if(s.isSameOrigin(e))return i.call(r,!1);if(n.g.XDomainRequest)return i.call(r,e.protocol===location.protocol);if(n.g.XMLHttpRequest){var o=new XMLHttpRequest;return i.call(r,void 0!==o.withCredentials)}return i.call(r,!1)}});t.exports=l},591:(t,e,n)=>{"use strict";var i=n(702),r=n(655),s=n(103),o=n(88),a=n(890),l=n(195),c=n(611),u=o(i(l,{initialize:function(t,e){if(l.prototype.initialize.call(this,t,e),!n.g.EventSource)return this.setDeferredStatus("failed");this._xhr=new c(t,e),(e=s(e)).pathname+="/"+t.clientId;var i=new n.g.EventSource(r.stringify(e)),o=this;i.onopen=function(){o._everConnected=!0,o.setDeferredStatus("succeeded")},i.onerror=function(){o._everConnected?o._handleError([]):(o.setDeferredStatus("failed"),i.close())},i.onmessage=function(t){var e;try{e=JSON.parse(t.data)}catch(t){}e?o._receive(e):o._handleError([])},this._socket=i},close:function(){this._socket&&(this._socket.onopen=this._socket.onerror=this._socket.onmessage=null,this._socket.close(),delete this._socket)},isUsable:function(t,e){this.callback((function(){t.call(e,!0)})),this.errback((function(){t.call(e,!1)}))},encode:function(t){return this._xhr.encode(t)},request:function(t){return this._xhr.request(t)}}),{isUsable:function(t,e,n,i){if(!t.clientId)return n.call(i,!1);c.isUsable(t,e,(function(r){if(!r)return n.call(i,!1);this.create(t,e).isUsable(n,i)}),this)},create:function(t,e){var n=t.transports.eventsource=t.transports.eventsource||{},i=t.clientId,o=s(e);return o.pathname+="/"+(i||""),n[o=r.stringify(o)]=n[o]||new this(t,e),n[o]}});o(u.prototype,a),t.exports=u},881:(t,e,n)=>{"use strict";var i=n(702),r=n(655),s=n(103),o=n(88),a=n(457),l=o(i(n(195),{encode:function(t){var e=s(this.endpoint);return e.query.message=a(t),e.query.jsonp="__jsonp"+l._cbCount+"__",r.stringify(e)},request:function(t){var e=document.getElementsByTagName("head")[0],i=document.createElement("script"),o=l.getCallbackName(),c=s(this.endpoint),u=this;c.query.message=a(t),c.query.jsonp=o;var h=function(){if(!n.g[o])return!1;n.g[o]=void 0;try{delete n.g[o]}catch(t){}i.parentNode.removeChild(i)};return n.g[o]=function(t){h(),u._receive(t)},i.type="text/javascript",i.src=r.stringify(c),e.appendChild(i),i.onerror=function(){h(),u._handleError(t)},{abort:h}}}),{_cbCount:0,getCallbackName:function(){return this._cbCount+=1,"__jsonp"+this._cbCount+"__"},isUsable:function(t,e,n,i){n.call(i,!0)}});t.exports=l},195:(t,e,n)=>{"use strict";var i=n(702),r=n(754).Cookie,s=n(857),o=n(722),a=n(88),l=n(782),c=n(840),u=n(762),h=a(i({className:"Transport",DEFAULT_PORTS:{"http:":80,"https:":443,"ws:":80,"wss:":443},MAX_DELAY:0,batching:!0,initialize:function(t,e){this._dispatcher=t,this.endpoint=e,this._outbox=[],this._proxy=a({},this._dispatcher.proxy),this._proxy.origin||(this._proxy.origin=this._findProxy())},close:function(){},encode:function(t){return""},sendMessage:function(t){return this.debug("Client ? sending message to ?: ?",this._dispatcher.clientId,this.endpoint.href,t),this.batching?(this._outbox.push(t),this._flushLargeBatch(),t.channel===u.HANDSHAKE?this._publish(.01):(t.channel===u.CONNECT&&(this._connectMessage=t),this._publish(this.MAX_DELAY))):s.resolve(this.request([t]))},_makePromise:function(){var t=this;this._requestPromise=this._requestPromise||new s((function(e){t._resolvePromise=e}))},_publish:function(t){return this._makePromise(),this.addTimeout("publish",t,(function(){this._flush(),delete this._requestPromise}),this),this._requestPromise},_flush:function(){this.removeTimeout("publish"),this._outbox.length>1&&this._connectMessage&&(this._connectMessage.advice={timeout:0}),this._resolvePromise(this.request(this._outbox)),this._connectMessage=null,this._outbox=[]},_flushLargeBatch:function(){if(!(this.encode(this._outbox).length<this._dispatcher.maxRequestSize)){var t=this._outbox.pop();this._makePromise(),this._flush(),t&&this._outbox.push(t)}},_receive:function(t){if(t){t=[].concat(t),this.debug("Client ? received from ? via ?: ?",this._dispatcher.clientId,this.endpoint.href,this.connectionType,t);for(var e=0,n=t.length;e<n;e++)this._dispatcher.handleResponse(t[e])}},_handleError:function(t,e){t=[].concat(t),this.debug("Client ? failed to send to ? via ?: ?",this._dispatcher.clientId,this.endpoint.href,this.connectionType,t);for(var n=0,i=t.length;n<i;n++)this._dispatcher.handleError(t[n])},_getCookies:function(){var t=this._dispatcher.cookies,e=this.endpoint.href;return t?o.map(t.getCookiesSync(e),(function(t){return t.cookieString()})).join("; "):""},_storeCookies:function(t){var e,n=this._dispatcher.cookies,i=this.endpoint.href;if(t&&n)for(var s=0,o=(t=[].concat(t)).length;s<o;s++)e=r.parse(t[s]),n.setCookieSync(e,i)},_findProxy:function(){if("undefined"!=typeof process){var t=this.endpoint.protocol;if(t){var e,n,i=t.replace(/:$/,"").toLowerCase()+"_proxy",r=i.toUpperCase(),s=process.env;return"http_proxy"===i&&s.REQUEST_METHOD?(1===(e=Object.keys(s).filter((function(t){return/^http_proxy$/i.test(t)}))).length?e[0]===i&&void 0===s[r]&&(n=s[i]):e.length>1&&(n=s[i]),n=n||s["CGI_"+r]):(n=s[i]||s[r])&&!s[i]&&console.warn("The environment variable "+r+" is discouraged. Use "+i+"."),n}}}}),{get:function(t,e,n,i,r){var s=t.endpoint;o.asyncEach(this._transports,(function(s,a){var l=s[0],c=s[1],u=t.endpointFor(l);return o.indexOf(n,l)>=0?a():o.indexOf(e,l)<0?(c.isUsable(t,u,(function(){})),a()):void c.isUsable(t,u,(function(e){if(!e)return a();var n=c.hasOwnProperty("create")?c.create(t,u):new c(t,u);i.call(r,n)}))}),(function(){throw new Error("Could not find a usable connection type for "+s.href)}))},register:function(t,e){this._transports.push([t,e]),e.prototype.connectionType=t},getConnectionTypes:function(){return o.map(this._transports,(function(t){return t[0]}))},disable:function(t){if("autodisconnect"===t)for(var e=0;e<this._transports.length;e++)this._transports[e][1]._unloaded=!1},_transports:[]});a(h.prototype,l),a(h.prototype,c),t.exports=h},182:(t,e,n)=>{"use strict";var i=n(702),r=n(857),s=n(172),o=n(655),a=n(375),l=n(103),c=n(88),u=n(457),h=n(3),d=n(890),p=c(i(n(195),{UNCONNECTED:1,CONNECTING:2,CONNECTED:3,batching:!1,isUsable:function(t,e){this.callback((function(){t.call(e,!0)})),this.errback((function(){t.call(e,!1)})),this.connect()},request:function(t){this._pending=this._pending||new s;for(var e=0,n=t.length;e<n;e++)this._pending.add(t[e]);var i=this,o=new r((function(e,n){i.callback((function(n){n&&1===n.readyState&&(n.send(u(t)),e(n))})),i.connect()}));return{abort:function(){o.then((function(t){t.close()}))}}},connect:function(){if(!p._unloaded&&(this._state=this._state||this.UNCONNECTED,this._state===this.UNCONNECTED)){this._state=this.CONNECTING;var t=this._createSocket();if(!t)return this.setDeferredStatus("failed");var e=this;t.onopen=function(){t.headers&&e._storeCookies(t.headers["set-cookie"]),e._socket=t,e._state=e.CONNECTED,e._everConnected=!0,e.setDeferredStatus("succeeded",t)};var n=!1;t.onclose=t.onerror=function(){if(!n){n=!0;var i=e._state===e.CONNECTED;t.onopen=t.onclose=t.onerror=t.onmessage=null,delete e._socket,e._state=e.UNCONNECTED;var r=e._pending?e._pending.toArray():[];delete e._pending,i||e._everConnected?(e.setDeferredStatus("unknown"),e._handleError(r,i)):e.setDeferredStatus("failed")}},t.onmessage=function(t){var n;try{n=JSON.parse(t.data)}catch(t){}if(n){for(var i=0,r=(n=[].concat(n)).length;i<r;i++)void 0!==n[i].successful&&e._pending.remove(n[i]);e._receive(n)}}}},close:function(){this._socket&&this._socket.close()},_createSocket:function(){var t=p.getSocketUrl(this.endpoint),e=this._dispatcher.headers,n=this._dispatcher.wsExtensions,i=this._getCookies(),r=this._dispatcher.tls,s={extensions:n,headers:e,proxy:this._proxy,tls:r};""!==i&&(s.headers.Cookie=i);try{return h.create(t,[],s)}catch(t){}}}),{PROTOCOLS:{"http:":"ws:","https:":"wss:"},create:function(t,e){var n=t.transports.websocket=t.transports.websocket||{};return n[e.href]=n[e.href]||new this(t,e),n[e.href]},getSocketUrl:function(t){return(t=l(t)).protocol=this.PROTOCOLS[t.protocol],o.stringify(t)},isUsable:function(t,e,n,i){this.create(t,e).isUsable(n,i)}});c(p.prototype,d),a.Event&&void 0!==n.g.onbeforeunload&&a.Event.on(n.g,"beforeunload",(function(){void 0===p._unloaded&&(p._unloaded=!0)})),t.exports=p},611:(t,e,n)=>{"use strict";var i=n(702),r=n(655),s=n(375),o=n(88),a=n(457),l=o(i(n(195),{encode:function(t){return a(t)},request:function(t){var e,i=this.endpoint.href,r=this;if(n.g.XMLHttpRequest)e=new XMLHttpRequest;else{if(!n.g.ActiveXObject)return this._handleError(t);e=new ActiveXObject("Microsoft.XMLHTTP")}e.open("POST",i,!0),e.setRequestHeader("Content-Type","application/json"),e.setRequestHeader("Pragma","no-cache"),e.setRequestHeader("X-Requested-With","XMLHttpRequest");var o=this._dispatcher.headers;for(var a in o)o.hasOwnProperty(a)&&e.setRequestHeader(a,o[a]);var l=function(){e.abort()};return void 0!==n.g.onbeforeunload&&s.Event.on(n.g,"beforeunload",l),e.onreadystatechange=function(){if(e&&4===e.readyState){var i=null,o=e.status,a=e.responseText,c=o>=200&&o<300||304===o||1223===o;if(void 0!==n.g.onbeforeunload&&s.Event.detach(n.g,"beforeunload",l),e.onreadystatechange=function(){},e=null,!c)return r._handleError(t);try{i=JSON.parse(a)}catch(t){}i?r._receive(i):r._handleError(t)}},e.send(this.encode(t)),e}}),{isUsable:function(t,e,n,i){var s="ReactNative"===navigator.product||r.isSameOrigin(e);n.call(i,s)}});t.exports=l},722:t=>{"use strict";t.exports={commonElement:function(t,e){for(var n=0,i=t.length;n<i;n++)if(-1!==this.indexOf(e,t[n]))return t[n];return null},indexOf:function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},map:function(t,e,n){if(t.map)return t.map(e,n);var i=[];if(t instanceof Array)for(var r=0,s=t.length;r<s;r++)i.push(e.call(n||null,t[r],r));else for(var o in t)t.hasOwnProperty(o)&&i.push(e.call(n||null,o,t[o]));return i},filter:function(t,e,n){if(t.filter)return t.filter(e,n);for(var i=[],r=0,s=t.length;r<s;r++)e.call(n||null,t[r],r)&&i.push(t[r]);return i},asyncEach:function(t,e,n,i){var r=t.length,s=-1,o=0,a=!1,l=function(){if(o-=1,(s+=1)===r)return n&&n.call(i);e(t[s],c)},c=function(){o+=1,function(){if(!a){for(a=!0;o>0;)l();a=!1}}()};c()}}},88:t=>{"use strict";var e=Array.prototype.forEach,n=Object.prototype.hasOwnProperty;t.exports=function(t){return e.call(arguments,(function(e,i){if(0!==i)for(var r in e)n.call(e,r)&&(t[r]=e[r])})),t}},375:(t,e,n)=>{"use strict";var i={_registry:[],on:function(t,e,n,i){var r=function(){n.call(i)};t.addEventListener?t.addEventListener(e,r,!1):t.attachEvent("on"+e,r),this._registry.push({_element:t,_type:e,_callback:n,_context:i,_handler:r})},detach:function(t,e,n,i){for(var r,s=this._registry.length;s--;)r=this._registry[s],t&&t!==r._element||e&&e!==r._type||n&&n!==r._callback||i&&i!==r._context||(r._element.removeEventListener?r._element.removeEventListener(r._type,r._handler,!1):r._element.detachEvent("on"+r._type,r._handler),this._registry.splice(s,1),r=null)}};void 0!==n.g.onunload&&i.on(n.g,"unload",i.detach,i),t.exports={Event:i}},702:(t,e,n)=>{"use strict";var i=n(88);t.exports=function(t,e){"function"!=typeof t&&(e=t,t=Object);var n=function(){return this.initialize&&this.initialize.apply(this,arguments)||this},r=function(){};return r.prototype=t.prototype,n.prototype=new r,i(n.prototype,e),n}},742:t=>{t.exports={VERSION:"1.4.0",BAYEUX_VERSION:"1.0",ID_LENGTH:160,JSONP_CALLBACK:"jsonpcallback",CONNECTION_TYPES:["long-polling","cross-origin-long-polling","callback-polling","websocket","eventsource","in-process"],MANDATORY_CONNECTION_TYPES:["long-polling","callback-polling","in-process"]}},754:t=>{"use strict";t.exports={}},103:t=>{"use strict";var e=function(t){var n,i,r;if(t instanceof Array){for(n=[],i=t.length;i--;)n[i]=e(t[i]);return n}if("object"==typeof t){for(r in n=null===t?null:{},t)n[r]=e(t[r]);return n}return t};t.exports=e},356:t=>{var e="function"==typeof Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};function n(){}t.exports=n,n.prototype.emit=function(t){if("error"===t&&(!this._events||!this._events.error||e(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var n=this._events[t];if(!n)return!1;if("function"==typeof n){switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:var i=Array.prototype.slice.call(arguments,1);n.apply(this,i)}return!0}if(e(n)){i=Array.prototype.slice.call(arguments,1);for(var r=n.slice(),s=0,o=r.length;s<o;s++)r[s].apply(this,i);return!0}return!1},n.prototype.addListener=function(t,n){if("function"!=typeof n)throw new Error("addListener only takes instances of Function");return this._events||(this._events={}),this.emit("newListener",t,n),this._events[t]?e(this._events[t])?this._events[t].push(n):this._events[t]=[this._events[t],n]:this._events[t]=n,this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){var n=this;return n.on(t,(function i(){n.removeListener(t,i),e.apply(this,arguments)})),this},n.prototype.removeListener=function(t,n){if("function"!=typeof n)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[t])return this;var i=this._events[t];if(e(i)){var r=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(e===t[n])return n;return-1}(i,n);if(r<0)return this;i.splice(r,1),0==i.length&&delete this._events[t]}else this._events[t]===n&&delete this._events[t];return this},n.prototype.removeAllListeners=function(t){return 0===arguments.length?(this._events={},this):(t&&this._events&&this._events[t]&&(this._events[t]=null),this)},n.prototype.listeners=function(t){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),e(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]}},857:(t,e,n)=>{"use strict";var i=n(272),r=function(t){this._state=-1,this._value=null,this._defer=[],s(this,t)};r.prototype.then=function(t,e){var n=new r,i={promise:n,onFulfilled:t,onRejected:e};return-1===this._state?this._defer.push(i):o(this,i),n},r.prototype.catch=function(t){return this.then(null,t)};var s=function(t,e){if("function"==typeof e){var n=0,i=function(e){0==n++&&u(t,e)};try{e((function(e){0==n++&&a(t,e)}),i)}catch(t){i(t)}}},o=function(t,e){var n=t._state,r=t._value,s=e.promise,o=[e.onFulfilled,e.onRejected][n];if("function"!=typeof o)return(0,[a,u][n])(s,r);i((function(){try{a(s,o(r))}catch(t){u(s,t)}}))},a=function(t,e){if(t===e)return u(t,new TypeError("Recursive promise chain detected"));var n;try{n=l(e)}catch(e){return u(t,e)}if(!n)return c(t,e);s(t,(function(t,i){n.call(e,t,i)}))},l=function(t){var e=typeof t,n=("object"===e||"function"===e)&&t&&t.then;return"function"==typeof n?n:null},c=function(t,e){h(t,0,e)},u=function(t,e){h(t,1,e)},h=function(t,e,n){var i=t._defer,r=0;if(t._state=e,t._value=n,t._defer=null,0!==i.length)for(;r<i.length;)o(t,i[r++])};r.resolve=function(t){try{if(l(t))return t}catch(t){return r.reject(t)}return new r((function(e,n){e(t)}))},r.reject=function(t){return new r((function(e,n){n(t)}))},r.all=function(t){return new r((function(e,n){var i,s=[],o=t.length;if(0===o)return e(s);var a=function(t,i){r.resolve(t).then((function(t){s[i]=t,0==--o&&e(s)}),n)};for(i=0;i<o;i++)a(t[i],i)}))},r.race=function(t){return new r((function(e,n){for(var i=0,s=t.length;i<s;i++)r.resolve(t[i]).then(e,n)}))},r.deferred=function(){var t={};return t.promise=new r((function(e,n){t.resolve=e,t.reject=n})),t},t.exports=r},172:(t,e,n)=>{"use strict";var i=n(702);t.exports=i({initialize:function(){this._index={}},add:function(t){var e=void 0!==t.id?t.id:t;return!this._index.hasOwnProperty(e)&&(this._index[e]=t,!0)},forEach:function(t,e){for(var n in this._index)this._index.hasOwnProperty(n)&&t.call(e,this._index[n])},isEmpty:function(){for(var t in this._index)if(this._index.hasOwnProperty(t))return!1;return!0},member:function(t){for(var e in this._index)if(this._index[e]===t)return!0;return!1},remove:function(t){var e=void 0!==t.id?t.id:t,n=this._index[e];return delete this._index[e],n},toArray:function(){var t=[];return this.forEach((function(e){t.push(e)})),t}})},457:t=>{"use strict";t.exports=function(t){return JSON.stringify(t,(function(t,e){return this[t]instanceof Array?this[t]:e}))}},655:t=>{"use strict";t.exports={isURI:function(t){return t&&t.protocol&&t.host&&t.path},isSameOrigin:function(t){return t.protocol===location.protocol&&t.hostname===location.hostname&&t.port===location.port},parse:function(t){if("string"!=typeof t)return t;var e,n,i,r,s,o,a={},l=function(e,n){t=t.replace(n,(function(t){return a[e]=t,""})),a[e]=a[e]||""};for(l("protocol",/^[a-z]+\:/i),l("host",/^\/\/[^\/\?#]+/),/^\//.test(t)||a.host||(t=location.pathname.replace(/[^\/]*$/,"")+t),l("pathname",/^[^\?#]*/),l("search",/^\?[^#]*/),l("hash",/^#.*/),a.protocol=a.protocol||location.protocol,a.host?(a.host=a.host.substr(2),/@/.test(a.host)&&(a.auth=a.host.split("@")[0],a.host=a.host.split("@")[1]),e=a.host.match(/^\[([^\]]+)\]|^[^:]+/),a.hostname=e[1]||e[0],a.port=(a.host.match(/:(\d+)$/)||[])[1]||""):(a.host=location.host,a.hostname=location.hostname,a.port=location.port),a.pathname=a.pathname||"/",a.path=a.pathname+a.search,o={},r=0,s=(i=(n=a.search.replace(/^\?/,""))?n.split("&"):[]).length;r<s;r++)e=i[r].split("="),o[decodeURIComponent(e[0]||"")]=decodeURIComponent(e[1]||"");return a.query=o,a.href=this.stringify(a),a},stringify:function(t){var e=t.auth?t.auth+"@":"",n=t.protocol+"//"+e+t.host;return n+=t.pathname+this.queryString(t.query)+(t.hash||"")},queryString:function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return 0===e.length?"":"?"+e.join("&")}}},978:(t,e,n)=>{"use strict";var i=n(722);t.exports=function(t,e){for(var n in t)if(i.indexOf(e,n)<0)throw new Error("Unrecognized option: "+n)}},3:(t,e,n)=>{"use strict";var i=n.g.MozWebSocket||n.g.WebSocket;t.exports={create:function(t,e,n){return"function"!=typeof i?null:new i(t)}}},959:(t,e,n)=>{!function(){var t;function e(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}var i="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){return t==Array.prototype||t==Object.prototype||(t[e]=n.value),t};var r,s=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g];for(var e=0;e<t.length;++e){var i=t[e];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")}(this);function o(t,e){if(e){for(var n=s,r=t.split("."),o=0;o<r.length-1;o++){var a=r[o];a in n||(n[a]={}),n=n[a]}(a=e(o=n[r=r[r.length-1]]))!=o&&null!=a&&i(n,r,{configurable:!0,writable:!0,value:a})}}function a(t){return(t={next:t})[Symbol.iterator]=function(){return this},t}function l(t){var n="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return n?n.call(t):{next:e(t)}}if(o("Symbol",(function(t){function e(t,e){this.o=t,i(this,"description",{configurable:!0,writable:!0,value:e})}if(t)return t;e.prototype.toString=function(){return this.o};var n=0;return function t(i){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return new e("jscomp_symbol_"+(i||"")+"_"+n++,i)}})),o("Symbol.iterator",(function(t){if(t)return t;t=Symbol("Symbol.iterator");for(var n="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),r=0;r<n.length;r++){var o=s[n[r]];"function"==typeof o&&"function"!=typeof o.prototype[t]&&i(o.prototype,t,{configurable:!0,writable:!0,value:function(){return a(e(this))}})}return t})),"function"==typeof Object.setPrototypeOf)r=Object.setPrototypeOf;else{var c;t:{var u={};try{u.__proto__={u:!0},c=u.u;break t}catch(t){}c=!1}r=c?function(t,e){if(t.__proto__=e,t.__proto__!==e)throw new TypeError(t+" is not extensible");return t}:null}var h=r;function d(){this.h=!1,this.f=null,this.m=void 0,this.b=1,this.l=this.v=0,this.g=null}function p(t){if(t.h)throw new TypeError("Generator is already running");t.h=!0}function f(t,e){return t.b=3,{value:e}}function m(t){this.a=new d,this.B=t}function g(t,e,n,i){try{var r=e.call(t.a.f,n);if(!(r instanceof Object))throw new TypeError("Iterator result "+r+" is not an object");if(!r.done)return t.a.h=!1,r;var s=r.value}catch(e){return t.a.f=null,t.a.j(e),v(t)}return t.a.f=null,i.call(t.a,s),v(t)}function v(t){for(;t.a.b;)try{var e=t.B(t.a);if(e)return t.a.h=!1,{value:e.value,done:!1}}catch(e){t.a.m=void 0,t.a.j(e)}if(t.a.h=!1,t.a.g){if(e=t.a.g,t.a.g=null,e.A)throw e.w;return{value:e.return,done:!0}}return{value:void 0,done:!0}}function y(t){this.next=function(e){return t.i(e)},this.throw=function(e){return t.j(e)},this.return=function(e){return function(t,e){p(t.a);var n=t.a.f;return n?g(t,"return"in n?n.return:function(t){return{value:t,done:!0}},e,t.a.return):(t.a.return(e),v(t))}(t,e)},this[Symbol.iterator]=function(){return this}}function _(t,e){var n=new y(new m(e));return h&&h(n,t.prototype),n}if(d.prototype.i=function(t){this.m=t},d.prototype.j=function(t){this.g={w:t,A:!0},this.b=this.v||this.l},d.prototype.return=function(t){this.g={return:t},this.b=this.l},m.prototype.i=function(t){return p(this.a),this.a.f?g(this,this.a.f.next,t,this.a.i):(this.a.i(t),v(this))},m.prototype.j=function(t){return p(this.a),this.a.f?g(this,this.a.f.throw,t,this.a.i):(this.a.j(t),v(this))},"undefined"!=typeof Blob&&("undefined"==typeof FormData||!FormData.prototype.keys)){var w=function(t,e){for(var n=0;n<t.length;n++)e(t[n])},b=function(t,e,n){return e instanceof Blob?[String(t),e,void 0!==n?n+"":"string"==typeof e.name?e.name:"blob"]:[String(t),String(e)]},S=function(t,e){if(t.length<e)throw new TypeError(e+" argument required, but only "+t.length+" present.")},E=function(t){var e=l(t);t=e.next().value;var n=e.next().value;return e=e.next().value,n instanceof Blob&&(n=new File([n],e,{type:n.type,lastModified:n.lastModified})),[t,n]},x="object"==typeof globalThis?globalThis:"object"==typeof window?window:"object"==typeof self?self:this,C=x.FormData,M=x.XMLHttpRequest&&x.XMLHttpRequest.prototype.send,k=x.Request&&x.fetch,T=x.navigator&&x.navigator.sendBeacon,I=x.Element&&x.Element.prototype,N=x.Symbol&&Symbol.toStringTag;N&&(Blob.prototype[N]||(Blob.prototype[N]="Blob"),"File"in x&&!File.prototype[N]&&(File.prototype[N]="File"));try{new File([],"")}catch(t){x.File=function(t,e,n){return t=new Blob(t,n),n=n&&void 0!==n.lastModified?new Date(n.lastModified):new Date,Object.defineProperties(t,{name:{value:e},lastModifiedDate:{value:n},lastModified:{value:+n},toString:{value:function(){return"[object File]"}}}),N&&Object.defineProperty(t,N,{value:"File"}),t}}var A=function(t){this.c=[];var e=this;t&&w(t.elements,(function(t){if(t.name&&!t.disabled&&"submit"!==t.type&&"button"!==t.type&&!t.matches("form fieldset[disabled] *"))if("file"===t.type){var n=t.files&&t.files.length?t.files:[new File([],"",{type:"application/octet-stream"})];w(n,(function(n){e.append(t.name,n)}))}else"select-multiple"===t.type||"select-one"===t.type?w(t.options,(function(n){!n.disabled&&n.selected&&e.append(t.name,n.value)})):"checkbox"===t.type||"radio"===t.type?t.checked&&e.append(t.name,t.value):(n="textarea"===t.type?t.value.replace(/\r\n/g,"\n").replace(/\n/g,"\r\n"):t.value,e.append(t.name,n))}))};if((t=A.prototype).append=function(t,e,n){S(arguments,2),this.c.push(b(t,e,n))},t.delete=function(t){S(arguments,1);var e=[];t=String(t),w(this.c,(function(n){n[0]!==t&&e.push(n)})),this.c=e},t.entries=function t(){var e,n=this;return _(t,(function(t){if(1==t.b&&(e=0),3!=t.b)return e<n.c.length?t=f(t,E(n.c[e])):(t.b=0,t=void 0),t;e++,t.b=2}))},t.forEach=function(t,e){S(arguments,1);for(var n=l(this),i=n.next();!i.done;i=n.next()){var r=l(i.value);i=r.next().value,r=r.next().value,t.call(e,r,i,this)}},t.get=function(t){S(arguments,1);var e=this.c;t=String(t);for(var n=0;n<e.length;n++)if(e[n][0]===t)return E(e[n])[1];return null},t.getAll=function(t){S(arguments,1);var e=[];return t=String(t),w(this.c,(function(n){n[0]===t&&e.push(E(n)[1])})),e},t.has=function(t){S(arguments,1),t=String(t);for(var e=0;e<this.c.length;e++)if(this.c[e][0]===t)return!0;return!1},t.keys=function t(){var e,n,i,r,s=this;return _(t,(function(t){if(1==t.b&&(e=l(s),n=e.next()),3!=t.b)return n.done?void(t.b=0):(i=n.value,r=l(i),f(t,r.next().value));n=e.next(),t.b=2}))},t.set=function(t,e,n){S(arguments,2),t=String(t);var i=[],r=b(t,e,n),s=!0;w(this.c,(function(e){e[0]===t?s&&(s=!i.push(r)):i.push(e)})),s&&i.push(r),this.c=i},t.values=function t(){var e,n,i,r,s=this;return _(t,(function(t){if(1==t.b&&(e=l(s),n=e.next()),3!=t.b)return n.done?void(t.b=0):(i=n.value,(r=l(i)).next(),f(t,r.next().value));n=e.next(),t.b=2}))},A.prototype._asNative=function(){for(var t=new C,e=l(this),n=e.next();!n.done;n=e.next()){var i=l(n.value);n=i.next().value,i=i.next().value,t.append(n,i)}return t},A.prototype._blob=function(){for(var t="----formdata-polyfill-"+Math.random(),e=[],n=l(this),i=n.next();!i.done;i=n.next()){var r=l(i.value);i=r.next().value,r=r.next().value,e.push("--"+t+"\r\n"),r instanceof Blob?e.push('Content-Disposition: form-data; name="'+i+'"; filename="'+r.name+'"\r\nContent-Type: '+(r.type||"application/octet-stream")+"\r\n\r\n",r,"\r\n"):e.push('Content-Disposition: form-data; name="'+i+'"\r\n\r\n'+r+"\r\n")}return e.push("--"+t+"--"),new Blob(e,{type:"multipart/form-data; boundary="+t})},A.prototype[Symbol.iterator]=function(){return this.entries()},A.prototype.toString=function(){return"[object FormData]"},I&&!I.matches&&(I.matches=I.matchesSelector||I.mozMatchesSelector||I.msMatchesSelector||I.oMatchesSelector||I.webkitMatchesSelector||function(t){for(var e=(t=(this.document||this.ownerDocument).querySelectorAll(t)).length;0<=--e&&t.item(e)!==this;);return-1<e}),N&&(A.prototype[N]="FormData"),M){var R=x.XMLHttpRequest.prototype.setRequestHeader;x.XMLHttpRequest.prototype.setRequestHeader=function(t,e){R.call(this,t,e),"content-type"===t.toLowerCase()&&(this.s=!0)},x.XMLHttpRequest.prototype.send=function(t){t instanceof A?(t=t._blob(),this.s||this.setRequestHeader("Content-Type",t.type),M.call(this,t)):M.call(this,t)}}k&&(x.fetch=function(t,e){return e&&e.body&&e.body instanceof A&&(e.body=e.body._blob()),k.call(this,t,e)}),T&&(x.navigator.sendBeacon=function(t,e){return e instanceof A&&(e=e._asNative()),T.call(this,t,e)}),x.FormData=A}}()},961:(t,e,n)=>{var i,r=function(){var t=String.fromCharCode,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",i={};function r(t,e){if(!i[t]){i[t]={};for(var n=0;n<t.length;n++)i[t][t.charAt(n)]=n}return i[t][e]}var s={compressToBase64:function(t){if(null==t)return"";var n=s._compress(t,6,(function(t){return e.charAt(t)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:s._decompress(t.length,32,(function(n){return r(e,t.charAt(n))}))},compressToUTF16:function(e){return null==e?"":s._compress(e,15,(function(e){return t(e+32)}))+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:s._decompress(t.length,16384,(function(e){return t.charCodeAt(e)-32}))},compressToUint8Array:function(t){for(var e=s.compress(t),n=new Uint8Array(2*e.length),i=0,r=e.length;i<r;i++){var o=e.charCodeAt(i);n[2*i]=o>>>8,n[2*i+1]=o%256}return n},decompressFromUint8Array:function(e){if(null==e)return s.decompress(e);for(var n=new Array(e.length/2),i=0,r=n.length;i<r;i++)n[i]=256*e[2*i]+e[2*i+1];var o=[];return n.forEach((function(e){o.push(t(e))})),s.decompress(o.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":s._compress(t,6,(function(t){return n.charAt(t)}))},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),s._decompress(t.length,32,(function(e){return r(n,t.charAt(e))})))},compress:function(e){return s._compress(e,16,(function(e){return t(e)}))},_compress:function(t,e,n){if(null==t)return"";var i,r,s,o={},a={},l="",c="",u="",h=2,d=3,p=2,f=[],m=0,g=0;for(s=0;s<t.length;s+=1)if(l=t.charAt(s),Object.prototype.hasOwnProperty.call(o,l)||(o[l]=d++,a[l]=!0),c=u+l,Object.prototype.hasOwnProperty.call(o,c))u=c;else{if(Object.prototype.hasOwnProperty.call(a,u)){if(u.charCodeAt(0)<256){for(i=0;i<p;i++)m<<=1,g==e-1?(g=0,f.push(n(m)),m=0):g++;for(r=u.charCodeAt(0),i=0;i<8;i++)m=m<<1|1&r,g==e-1?(g=0,f.push(n(m)),m=0):g++,r>>=1}else{for(r=1,i=0;i<p;i++)m=m<<1|r,g==e-1?(g=0,f.push(n(m)),m=0):g++,r=0;for(r=u.charCodeAt(0),i=0;i<16;i++)m=m<<1|1&r,g==e-1?(g=0,f.push(n(m)),m=0):g++,r>>=1}0==--h&&(h=Math.pow(2,p),p++),delete a[u]}else for(r=o[u],i=0;i<p;i++)m=m<<1|1&r,g==e-1?(g=0,f.push(n(m)),m=0):g++,r>>=1;0==--h&&(h=Math.pow(2,p),p++),o[c]=d++,u=String(l)}if(""!==u){if(Object.prototype.hasOwnProperty.call(a,u)){if(u.charCodeAt(0)<256){for(i=0;i<p;i++)m<<=1,g==e-1?(g=0,f.push(n(m)),m=0):g++;for(r=u.charCodeAt(0),i=0;i<8;i++)m=m<<1|1&r,g==e-1?(g=0,f.push(n(m)),m=0):g++,r>>=1}else{for(r=1,i=0;i<p;i++)m=m<<1|r,g==e-1?(g=0,f.push(n(m)),m=0):g++,r=0;for(r=u.charCodeAt(0),i=0;i<16;i++)m=m<<1|1&r,g==e-1?(g=0,f.push(n(m)),m=0):g++,r>>=1}0==--h&&(h=Math.pow(2,p),p++),delete a[u]}else for(r=o[u],i=0;i<p;i++)m=m<<1|1&r,g==e-1?(g=0,f.push(n(m)),m=0):g++,r>>=1;0==--h&&(h=Math.pow(2,p),p++)}for(r=2,i=0;i<p;i++)m=m<<1|1&r,g==e-1?(g=0,f.push(n(m)),m=0):g++,r>>=1;for(;;){if(m<<=1,g==e-1){f.push(n(m));break}g++}return f.join("")},decompress:function(t){return null==t?"":""==t?null:s._decompress(t.length,32768,(function(e){return t.charCodeAt(e)}))},_decompress:function(e,n,i){var r,s,o,a,l,c,u,h=[],d=4,p=4,f=3,m="",g=[],v={val:i(0),position:n,index:1};for(r=0;r<3;r+=1)h[r]=r;for(o=0,l=Math.pow(2,2),c=1;c!=l;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=i(v.index++)),o|=(a>0?1:0)*c,c<<=1;switch(o){case 0:for(o=0,l=Math.pow(2,8),c=1;c!=l;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=i(v.index++)),o|=(a>0?1:0)*c,c<<=1;u=t(o);break;case 1:for(o=0,l=Math.pow(2,16),c=1;c!=l;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=i(v.index++)),o|=(a>0?1:0)*c,c<<=1;u=t(o);break;case 2:return""}for(h[3]=u,s=u,g.push(u);;){if(v.index>e)return"";for(o=0,l=Math.pow(2,f),c=1;c!=l;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=i(v.index++)),o|=(a>0?1:0)*c,c<<=1;switch(u=o){case 0:for(o=0,l=Math.pow(2,8),c=1;c!=l;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=i(v.index++)),o|=(a>0?1:0)*c,c<<=1;h[p++]=t(o),u=p-1,d--;break;case 1:for(o=0,l=Math.pow(2,16),c=1;c!=l;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=i(v.index++)),o|=(a>0?1:0)*c,c<<=1;h[p++]=t(o),u=p-1,d--;break;case 2:return g.join("")}if(0==d&&(d=Math.pow(2,f),f++),h[u])m=h[u];else{if(u!==p)return null;m=s+s.charAt(0)}g.push(m),h[p++]=s+m.charAt(0),s=m,0==--d&&(d=Math.pow(2,f),f++)}}};return s}();void 0===(i=function(){return r}.call(e,n,e,t))||(t.exports=i)}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={exports:{}};return t[i].call(s.exports,s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";let t=new google.maps.ElevationService,e=new google.maps.StreetViewService,i=new google.maps.Geocoder;function r(t,n){return new Promise((function(i,r){let s={location:t,radius:n};e.getPanorama(s,(t,e)=>{e==google.maps.StreetViewStatus.OK?i(t):r(new Error(e))})}))}function s(e){return new Promise((function(n,i){t.getElevationAlongPath(e,(t,e)=>{e==google.maps.ElevationStatus.OK?n(t):i(new Error(e))})}))}const o={STRAVA_CLIENT_ID:void 0,STRAVA_CLIENT_SECRET:void 0,STRAVA_ACCESS_TOKEN:void 0};function a(t){return new Promise(e=>setTimeout(e,t))}function l(t){let e=t.getUTCMonth()+1;e=e<10?"0"+e:e;let n=t.getUTCDate();n=n<10?"0"+n:n;let i=t.getUTCHours();i=i<10?"0"+i:i;let r=t.getUTCMinutes();r=r<10?"0"+r:r;let s=t.getUTCSeconds();return s=s<10?"0"+s:s,t.getUTCFullYear()+"-"+e+"-"+n+"T"+i+":"+r+":"+s+"Z"}function c(){let t=localStorage.getItem("strava-oauth"+o.STRAVA_CLIENT_ID),e=!1;if(null!=t&&""!==t&&"undefined"!==t&&"null"!==t){let n=JSON.parse(t);n.access_token&&n.refresh_token&&(e=!0)}return e}function u(){let t,e=localStorage.getItem("strava-oauth"+o.STRAVA_CLIENT_ID);return t=null!=e&&""!==e&&"undefined"!==e&&"null"!==e?JSON.parse(e):{},t}function h(t){localStorage.setItem("strava-oauth"+o.STRAVA_CLIENT_ID,JSON.stringify(t))}function d(t,e,n){var i=.99999683+n*(n*(78736169e-12+n*(n*(4.3884187e-9+n*(n*(21874425e-20+n*(n*(11112018e-24+-3.0994571e-20*n)-17892321e-22))-29883885e-18))-6.1117958e-7))-.0090826951),r=100*(6.1078/Math.pow(i,8));return(100*e-r)/(287.0531*(t+273.15))+r/(461.4964*(t+273.15))}function p(t,e){var n=function(t,e){var n=9.8067*(e.rp_wr+e.rp_wb)*Math.sin(Math.atan(e.ep_g/100)),i=9.8067*(e.rp_wr+e.rp_wb)*Math.cos(Math.atan(e.ep_g/100))*e.ep_crr,r=.5*e.rp_a*e.rp_cd*e.ep_rho*(1e3*t/3600)*(1e3*t/3600),s={};return s.Fgravity=n,s.Frolling=i,s.Fdrag=r,s}(t,e);return(n.Fgravity+n.Frolling+n.Fdrag)*(1e3*t/3600)/(1-e.rp_dtl/100)}var f=Object.prototype.toString,m=Array.isArray||function(t){return"[object Array]"===f.call(t)};function g(t){return"function"==typeof t}function v(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function y(t,e){return null!=t&&"object"==typeof t&&e in t}var _=RegExp.prototype.test;var w=/\S/;function b(t){return!function(t,e){return _.call(t,e)}(w,t)}var S={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};var E=/\s*/,x=/\s+/,C=/\s*=/,M=/\s*\}/,k=/#|\^|\/|>|\{|&|=|!/;function T(t){this.string=t,this.tail=t,this.pos=0}function I(t,e){this.view=t,this.cache={".":this.view},this.parent=e}function N(){this.templateCache={_cache:{},set:function(t,e){this._cache[t]=e},get:function(t){return this._cache[t]},clear:function(){this._cache={}}}}T.prototype.eos=function(){return""===this.tail},T.prototype.scan=function(t){var e=this.tail.match(t);if(!e||0!==e.index)return"";var n=e[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},T.prototype.scanUntil=function(t){var e,n=this.tail.search(t);switch(n){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=e.length,e},I.prototype.push=function(t){return new I(t,this)},I.prototype.lookup=function(t){var e,n,i,r=this.cache;if(r.hasOwnProperty(t))e=r[t];else{for(var s,o,a,l=this,c=!1;l;){if(t.indexOf(".")>0)for(s=l.view,o=t.split("."),a=0;null!=s&&a<o.length;)a===o.length-1&&(c=y(s,o[a])||(n=s,i=o[a],null!=n&&"object"!=typeof n&&n.hasOwnProperty&&n.hasOwnProperty(i))),s=s[o[a++]];else s=l.view[t],c=y(l.view,t);if(c){e=s;break}l=l.parent}r[t]=e}return g(e)&&(e=e.call(this.view)),e},N.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},N.prototype.parse=function(t,e){var n=this.templateCache,i=t+":"+(e||A.tags).join(":"),r=void 0!==n,s=r?n.get(i):void 0;return null==s&&(s=function(t,e){if(!t)return[];var n,i,r,s=!1,o=[],a=[],l=[],c=!1,u=!1,h="",d=0;function p(){if(c&&!u)for(;l.length;)delete a[l.pop()];else l=[];c=!1,u=!1}function f(t){if("string"==typeof t&&(t=t.split(x,2)),!m(t)||2!==t.length)throw new Error("Invalid tags: "+t);n=new RegExp(v(t[0])+"\\s*"),i=new RegExp("\\s*"+v(t[1])),r=new RegExp("\\s*"+v("}"+t[1]))}f(e||A.tags);for(var g,y,_,w,S,I,N=new T(t);!N.eos();){if(g=N.pos,_=N.scanUntil(n))for(var R=0,L=_.length;R<L;++R)b(w=_.charAt(R))?(l.push(a.length),h+=w):(u=!0,s=!0,h+=" "),a.push(["text",w,g,g+1]),g+=1,"\n"===w&&(p(),h="",d=0,s=!1);if(!N.scan(n))break;if(c=!0,y=N.scan(k)||"name",N.scan(E),"="===y?(_=N.scanUntil(C),N.scan(C),N.scanUntil(i)):"{"===y?(_=N.scanUntil(r),N.scan(M),N.scanUntil(i),y="&"):_=N.scanUntil(i),!N.scan(i))throw new Error("Unclosed tag at "+N.pos);if(S=">"==y?[y,_,g,N.pos,h,d,s]:[y,_,g,N.pos],d++,a.push(S),"#"===y||"^"===y)o.push(S);else if("/"===y){if(!(I=o.pop()))throw new Error('Unopened section "'+_+'" at '+g);if(I[1]!==_)throw new Error('Unclosed section "'+I[1]+'" at '+g)}else"name"===y||"{"===y||"&"===y?u=!0:"="===y&&f(_)}if(p(),I=o.pop())throw new Error('Unclosed section "'+I[1]+'" at '+N.pos);return function(t){for(var e,n=[],i=n,r=[],s=0,o=t.length;s<o;++s)switch((e=t[s])[0]){case"#":case"^":i.push(e),r.push(e),i=e[4]=[];break;case"/":r.pop()[5]=e[2],i=r.length>0?r[r.length-1][4]:n;break;default:i.push(e)}return n}(function(t){for(var e,n,i=[],r=0,s=t.length;r<s;++r)(e=t[r])&&("text"===e[0]&&n&&"text"===n[0]?(n[1]+=e[1],n[3]=e[3]):(i.push(e),n=e));return i}(a))}(t,e),r&&n.set(i,s)),s},N.prototype.render=function(t,e,n,i){var r=this.getConfigTags(i),s=this.parse(t,r),o=e instanceof I?e:new I(e,void 0);return this.renderTokens(s,o,n,t,i)},N.prototype.renderTokens=function(t,e,n,i,r){for(var s,o,a,l="",c=0,u=t.length;c<u;++c)a=void 0,"#"===(o=(s=t[c])[0])?a=this.renderSection(s,e,n,i,r):"^"===o?a=this.renderInverted(s,e,n,i,r):">"===o?a=this.renderPartial(s,e,n,r):"&"===o?a=this.unescapedValue(s,e):"name"===o?a=this.escapedValue(s,e,r):"text"===o&&(a=this.rawValue(s)),void 0!==a&&(l+=a);return l},N.prototype.renderSection=function(t,e,n,i,r){var s=this,o="",a=e.lookup(t[1]);if(a){if(m(a))for(var l=0,c=a.length;l<c;++l)o+=this.renderTokens(t[4],e.push(a[l]),n,i,r);else if("object"==typeof a||"string"==typeof a||"number"==typeof a)o+=this.renderTokens(t[4],e.push(a),n,i,r);else if(g(a)){if("string"!=typeof i)throw new Error("Cannot use higher-order sections without the original template");null!=(a=a.call(e.view,i.slice(t[3],t[5]),(function(t){return s.render(t,e,n,r)})))&&(o+=a)}else o+=this.renderTokens(t[4],e,n,i,r);return o}},N.prototype.renderInverted=function(t,e,n,i,r){var s=e.lookup(t[1]);if(!s||m(s)&&0===s.length)return this.renderTokens(t[4],e,n,i,r)},N.prototype.indentPartial=function(t,e,n){for(var i=e.replace(/[^ \t]/g,""),r=t.split("\n"),s=0;s<r.length;s++)r[s].length&&(s>0||!n)&&(r[s]=i+r[s]);return r.join("\n")},N.prototype.renderPartial=function(t,e,n,i){if(n){var r=this.getConfigTags(i),s=g(n)?n(t[1]):n[t[1]];if(null!=s){var o=t[6],a=t[5],l=t[4],c=s;0==a&&l&&(c=this.indentPartial(s,l,o));var u=this.parse(c,r);return this.renderTokens(u,e,n,c,i)}}},N.prototype.unescapedValue=function(t,e){var n=e.lookup(t[1]);if(null!=n)return n},N.prototype.escapedValue=function(t,e,n){var i=this.getConfigEscape(n)||A.escape,r=e.lookup(t[1]);if(null!=r)return"number"==typeof r&&i===A.escape?String(r):i(r)},N.prototype.rawValue=function(t){return t[1]},N.prototype.getConfigTags=function(t){return m(t)?t:t&&"object"==typeof t?t.tags:void 0},N.prototype.getConfigEscape=function(t){return t&&"object"==typeof t&&!m(t)?t.escape:void 0};var A={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(t){R.templateCache=t},get templateCache(){return R.templateCache}},R=new N;A.clearCache=function(){return R.clearCache()},A.parse=function(t,e){return R.parse(t,e)},A.render=function(t,e,n,i){if("string"!=typeof t)throw new TypeError('Invalid template! Template should be a "string" but "'+((m(r=t)?"array":typeof r)+'" was given as the first argument for mustache#render(template, view, partials)'));var r;return R.render(t,e,n,i)},A.escape=function(t){return String(t).replace(/[&<>"'`=\/]/g,(function(t){return S[t]}))},A.Scanner=T,A.Context=I,A.Writer=N;const L=A;function O(){}function D(t){return null==t?O:function(){return this.querySelector(t)}}function P(){return[]}function U(t){return new Array(t.length)}function B(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}B.prototype={constructor:B,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function q(t,e,n,i,r,s){for(var o,a=0,l=e.length,c=s.length;a<c;++a)(o=e[a])?(o.__data__=s[a],i[a]=o):n[a]=new B(t,s[a]);for(;a<l;++a)(o=e[a])&&(r[a]=o)}function j(t,e,n,i,r,s,o){var a,l,c,u={},h=e.length,d=s.length,p=new Array(h);for(a=0;a<h;++a)(l=e[a])&&(p[a]=c="$"+o.call(l,l.__data__,a,e),c in u?r[a]=l:u[c]=l);for(a=0;a<d;++a)(l=u[c="$"+o.call(t,s[a],a,s)])?(i[a]=l,l.__data__=s[a],u[c]=null):n[a]=new B(t,s[a]);for(a=0;a<h;++a)(l=e[a])&&u[p[a]]===l&&(r[a]=l)}function F(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var H="http://www.w3.org/1999/xhtml";const z={svg:"http://www.w3.org/2000/svg",xhtml:H,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function V(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),z.hasOwnProperty(e)?{space:z[e],local:t}:t}function W(t){return function(){this.removeAttribute(t)}}function J(t){return function(){this.removeAttributeNS(t.space,t.local)}}function $(t,e){return function(){this.setAttribute(t,e)}}function G(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function X(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function Y(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function K(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Z(t){return function(){this.style.removeProperty(t)}}function Q(t,e,n){return function(){this.style.setProperty(t,e,n)}}function tt(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function et(t,e){return t.style.getPropertyValue(e)||K(t).getComputedStyle(t,null).getPropertyValue(e)}function nt(t){return function(){delete this[t]}}function it(t,e){return function(){this[t]=e}}function rt(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function st(t){return t.trim().split(/^|\s+/)}function ot(t){return t.classList||new at(t)}function at(t){this._node=t,this._names=st(t.getAttribute("class")||"")}function lt(t,e){for(var n=ot(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function ct(t,e){for(var n=ot(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function ut(t){return function(){lt(this,t)}}function ht(t){return function(){ct(this,t)}}function dt(t,e){return function(){(e.apply(this,arguments)?lt:ct)(this,t)}}function pt(){this.textContent=""}function ft(t){return function(){this.textContent=t}}function mt(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function gt(){this.innerHTML=""}function vt(t){return function(){this.innerHTML=t}}function yt(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function _t(){this.nextSibling&&this.parentNode.appendChild(this)}function wt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function bt(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===H&&e.documentElement.namespaceURI===H?e.createElement(t):e.createElementNS(n,t)}}function St(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Et(t){var e=V(t);return(e.local?St:bt)(e)}function xt(){return null}function Ct(){var t=this.parentNode;t&&t.removeChild(this)}function Mt(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function kt(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}at.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Tt={},It=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(Tt={mouseenter:"mouseover",mouseleave:"mouseout"}));function Nt(t,e,n){return t=At(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function At(t,e,n){return function(i){var r=It;It=i;try{t.call(this,this.__data__,e,n)}finally{It=r}}}function Rt(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function Lt(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,s=e.length;i<s;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.capture);++r?e.length=r:delete this.__on}}}function Ot(t,e,n){var i=Tt.hasOwnProperty(t.type)?Nt:At;return function(r,s,o){var a,l=this.__on,c=i(e,s,o);if(l)for(var u=0,h=l.length;u<h;++u)if((a=l[u]).type===t.type&&a.name===t.name)return this.removeEventListener(a.type,a.listener,a.capture),this.addEventListener(a.type,a.listener=c,a.capture=n),void(a.value=e);this.addEventListener(t.type,c,n),a={type:t.type,name:t.name,value:e,listener:c,capture:n},l?l.push(a):this.__on=[a]}}function Dt(t,e,n){var i=K(t),r=i.CustomEvent;"function"==typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function Pt(t,e){return function(){return Dt(this,t,e)}}function Ut(t,e){return function(){return Dt(this,t,e.apply(this,arguments))}}var Bt=[null];function qt(t,e){this._groups=t,this._parents=e}function jt(){return new qt([[document.documentElement]],Bt)}qt.prototype=jt.prototype={constructor:qt,select:function(t){"function"!=typeof t&&(t=D(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s,o,a=e[r],l=a.length,c=i[r]=new Array(l),u=0;u<l;++u)(s=a[u])&&(o=t.call(s,s.__data__,u,a))&&("__data__"in s&&(o.__data__=s.__data__),c[u]=o);return new qt(i,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=function(t){return null==t?P:function(){return this.querySelectorAll(t)}}(t));for(var e=this._groups,n=e.length,i=[],r=[],s=0;s<n;++s)for(var o,a=e[s],l=a.length,c=0;c<l;++c)(o=a[c])&&(i.push(t.call(o,o.__data__,c,a)),r.push(o));return new qt(i,r)},filter:function(t){"function"!=typeof t&&(t=function(t){return function(){return this.matches(t)}}(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s,o=e[r],a=o.length,l=i[r]=[],c=0;c<a;++c)(s=o[c])&&t.call(s,s.__data__,c,o)&&l.push(s);return new qt(i,this._parents)},data:function(t,e){if(!t)return f=new Array(this.size()),u=-1,this.each((function(t){f[++u]=t})),f;var n,i=e?j:q,r=this._parents,s=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var o=s.length,a=new Array(o),l=new Array(o),c=new Array(o),u=0;u<o;++u){var h=r[u],d=s[u],p=d.length,f=t.call(h,h&&h.__data__,u,r),m=f.length,g=l[u]=new Array(m),v=a[u]=new Array(m);i(h,d,g,v,c[u]=new Array(p),f,e);for(var y,_,w=0,b=0;w<m;++w)if(y=g[w]){for(w>=b&&(b=w+1);!(_=v[b])&&++b<m;);y._next=_||null}}return(a=new qt(a,r))._enter=l,a._exit=c,a},enter:function(){return new qt(this._enter||this._groups.map(U),this._parents)},exit:function(){return new qt(this._exit||this._groups.map(U),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,s=this.exit();return i="function"==typeof t?t(i):i.append(t+""),null!=e&&(r=e(r)),null==n?s.remove():n(s),i&&r?i.merge(r).order():r},merge:function(t){for(var e=this._groups,n=t._groups,i=e.length,r=n.length,s=Math.min(i,r),o=new Array(i),a=0;a<s;++a)for(var l,c=e[a],u=n[a],h=c.length,d=o[a]=new Array(h),p=0;p<h;++p)(l=c[p]||u[p])&&(d[p]=l);for(;a<i;++a)o[a]=e[a];return new qt(o,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],s=r.length-1,o=r[s];--s>=0;)(i=r[s])&&(o&&4^i.compareDocumentPosition(o)&&o.parentNode.insertBefore(i,o),o=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=F);for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s){for(var o,a=n[s],l=a.length,c=r[s]=new Array(l),u=0;u<l;++u)(o=a[u])&&(c[u]=o);c.sort(e)}return new qt(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length;r<s;++r){var o=i[r];if(o)return o}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,s=e[n],o=0,a=s.length;o<a;++o)(r=s[o])&&t.call(r,r.__data__,o,s);return this},attr:function(t,e){var n=V(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?J:W:"function"==typeof e?n.local?Y:X:n.local?G:$)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?Z:"function"==typeof e?tt:Q)(t,e,null==n?"":n)):et(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?nt:"function"==typeof e?rt:it)(t,e)):this.node()[t]},classed:function(t,e){var n=st(t+"");if(arguments.length<2){for(var i=ot(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?dt:e?ut:ht)(n,e))},text:function(t){return arguments.length?this.each(null==t?pt:("function"==typeof t?mt:ft)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?gt:("function"==typeof t?yt:vt)(t)):this.node().innerHTML},raise:function(){return this.each(_t)},lower:function(){return this.each(wt)},append:function(t){var e="function"==typeof t?t:Et(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:Et(t),i=null==e?xt:"function"==typeof e?e:D(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(Ct)},clone:function(t){return this.select(t?kt:Mt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,s=Rt(t+""),o=s.length;if(!(arguments.length<2)){for(a=e?Ot:Lt,null==n&&(n=!1),i=0;i<o;++i)this.each(a(s[i],e,n));return this}var a=this.node().__on;if(a)for(var l,c=0,u=a.length;c<u;++c)for(i=0,l=a[c];i<o;++i)if((r=s[i]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?Ut:Pt)(t,e))}};function Ft(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var Ht,zt,Vt=(1===(Ht=Ft).length&&(zt=Ht,Ht=function(t,e){return Ft(zt(t),e)}),{left:function(t,e,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){var r=n+i>>>1;Ht(t[r],e)<0?n=r+1:i=r}return n},right:function(t,e,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){var r=n+i>>>1;Ht(t[r],e)>0?i=r:n=r+1}return n}});const Wt=Vt.right;var Jt=Array.prototype,$t=(Jt.slice,Jt.map,Math.sqrt(50)),Gt=Math.sqrt(10),Xt=Math.sqrt(2);function Yt(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),s=i/Math.pow(10,r);return r>=0?(s>=$t?10:s>=Gt?5:s>=Xt?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(s>=$t?10:s>=Gt?5:s>=Xt?2:1)}function Kt(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Zt(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Qt(){}var te="\\s*([+-]?\\d+)\\s*",ee="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ne="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ie=/^#([0-9a-f]{3,8})$/,re=new RegExp("^rgb\\("+[te,te,te]+"\\)$"),se=new RegExp("^rgb\\("+[ne,ne,ne]+"\\)$"),oe=new RegExp("^rgba\\("+[te,te,te,ee]+"\\)$"),ae=new RegExp("^rgba\\("+[ne,ne,ne,ee]+"\\)$"),le=new RegExp("^hsl\\("+[ee,ne,ne]+"\\)$"),ce=new RegExp("^hsla\\("+[ee,ne,ne,ee]+"\\)$"),ue={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function he(){return this.rgb().formatHex()}function de(){return this.rgb().formatRgb()}function pe(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=ie.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?fe(e):3===n?new ye(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?me(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?me(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=re.exec(t))?new ye(e[1],e[2],e[3],1):(e=se.exec(t))?new ye(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=oe.exec(t))?me(e[1],e[2],e[3],e[4]):(e=ae.exec(t))?me(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=le.exec(t))?Se(e[1],e[2]/100,e[3]/100,1):(e=ce.exec(t))?Se(e[1],e[2]/100,e[3]/100,e[4]):ue.hasOwnProperty(t)?fe(ue[t]):"transparent"===t?new ye(NaN,NaN,NaN,0):null}function fe(t){return new ye(t>>16&255,t>>8&255,255&t,1)}function me(t,e,n,i){return i<=0&&(t=e=n=NaN),new ye(t,e,n,i)}function ge(t){return t instanceof Qt||(t=pe(t)),t?new ye((t=t.rgb()).r,t.g,t.b,t.opacity):new ye}function ve(t,e,n,i){return 1===arguments.length?ge(t):new ye(t,e,n,null==i?1:i)}function ye(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function _e(){return"#"+be(this.r)+be(this.g)+be(this.b)}function we(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function be(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Se(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new xe(t,e,n,i)}function Ee(t){if(t instanceof xe)return new xe(t.h,t.s,t.l,t.opacity);if(t instanceof Qt||(t=pe(t)),!t)return new xe;if(t instanceof xe)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),o=NaN,a=s-r,l=(s+r)/2;return a?(o=e===s?(n-i)/a+6*(n<i):n===s?(i-e)/a+2:(e-n)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new xe(o,a,l,t.opacity)}function xe(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function Ce(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Me(t,e,n,i,r){var s=t*t,o=s*t;return((1-3*t+3*s-o)*e+(4-6*s+3*o)*n+(1+3*t+3*s-3*o)*i+o*r)/6}function ke(t){return function(){return t}}function Te(t,e){return function(n){return t+n*e}}function Ie(t){return 1==(t=+t)?Ne:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):ke(isNaN(e)?n:e)}}function Ne(t,e){var n=e-t;return n?Te(t,n):ke(isNaN(t)?e:t)}Kt(Qt,pe,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:he,formatHex:he,formatHsl:function(){return Ee(this).formatHsl()},formatRgb:de,toString:de}),Kt(ye,ve,Zt(Qt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new ye(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ye(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:_e,formatHex:_e,formatRgb:we,toString:we})),Kt(xe,(function(t,e,n,i){return 1===arguments.length?Ee(t):new xe(t,e,n,null==i?1:i)}),Zt(Qt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new xe(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new xe(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new ye(Ce(t>=240?t-240:t+120,r,i),Ce(t,r,i),Ce(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));const Ae=function t(e){var n=Ie(e);function i(t,e){var i=n((t=ve(t)).r,(e=ve(e)).r),r=n(t.g,e.g),s=n(t.b,e.b),o=Ne(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=s(e),t.opacity=o(e),t+""}}return i.gamma=t,i}(1);function Re(t){return function(e){var n,i,r=e.length,s=new Array(r),o=new Array(r),a=new Array(r);for(n=0;n<r;++n)i=ve(e[n]),s[n]=i.r||0,o[n]=i.g||0,a[n]=i.b||0;return s=t(s),o=t(o),a=t(a),i.opacity=1,function(t){return i.r=s(t),i.g=o(t),i.b=a(t),i+""}}}Re((function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],s=t[i+1],o=i>0?t[i-1]:2*r-s,a=i<e-1?t[i+2]:2*s-r;return Me((n-i/e)*e,o,r,s,a)}})),Re((function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),r=t[(i+e-1)%e],s=t[i%e],o=t[(i+1)%e],a=t[(i+2)%e];return Me((n-i/e)*e,r,s,o,a)}}));function Le(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,s=new Array(r),o=new Array(i);for(n=0;n<r;++n)s[n]=Fe(t[n],e[n]);for(;n<i;++n)o[n]=e[n];return function(t){for(n=0;n<r;++n)o[n]=s[n](t);return o}}function Oe(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function De(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Pe(t,e){var n,i={},r={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?i[n]=Fe(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}}var Ue=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Be=new RegExp(Ue.source,"g");function qe(t,e){var n,i,r,s=Ue.lastIndex=Be.lastIndex=0,o=-1,a=[],l=[];for(t+="",e+="";(n=Ue.exec(t))&&(i=Be.exec(e));)(r=i.index)>s&&(r=e.slice(s,r),a[o]?a[o]+=r:a[++o]=r),(n=n[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,l.push({i:o,x:De(n,i)})),s=Be.lastIndex;return s<e.length&&(r=e.slice(s),a[o]?a[o]+=r:a[++o]=r),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,i=0;i<e;++i)a[(n=l[i]).i]=n.x(t);return a.join("")})}function je(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,r=e.slice();return function(s){for(n=0;n<i;++n)r[n]=t[n]*(1-s)+e[n]*s;return r}}function Fe(t,e){var n,i,r=typeof e;return null==e||"boolean"===r?ke(e):("number"===r?De:"string"===r?(n=pe(e))?(e=n,Ae):qe:e instanceof pe?Ae:e instanceof Date?Oe:(i=e,!ArrayBuffer.isView(i)||i instanceof DataView?Array.isArray(e)?Le:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Pe:De:je))(t,e)}function He(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var ze=Array.prototype,Ve=ze.map,We=ze.slice;function Je(t){return+t}var $e=[0,1];function Ge(t){return t}function Xe(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function Ye(t){var e,n=t[0],i=t[t.length-1];return n>i&&(e=n,n=i,i=e),function(t){return Math.max(n,Math.min(i,t))}}function Ke(t,e,n){var i=t[0],r=t[1],s=e[0],o=e[1];return r<i?(i=Xe(r,i),s=n(o,s)):(i=Xe(i,r),s=n(s,o)),function(t){return s(i(t))}}function Ze(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),s=new Array(i),o=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<i;)r[o]=Xe(t[o],t[o+1]),s[o]=n(e[o],e[o+1]);return function(e){var n=Wt(t,e,1,i)-1;return s[n](r[n](e))}}function Qe(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function tn(t,e){return function(){var t,e,n,i,r,s,o=$e,a=$e,l=Fe,c=Ge;function u(){return i=Math.min(o.length,a.length)>2?Ze:Ke,r=s=null,h}function h(e){return isNaN(e=+e)?n:(r||(r=i(o.map(t),a,l)))(t(c(e)))}return h.invert=function(n){return c(e((s||(s=i(a,o.map(t),De)))(n)))},h.domain=function(t){return arguments.length?(o=Ve.call(t,Je),c===Ge||(c=Ye(o)),u()):o.slice()},h.range=function(t){return arguments.length?(a=We.call(t),u()):a.slice()},h.rangeRound=function(t){return a=We.call(t),l=He,u()},h.clamp=function(t){return arguments.length?(c=t?Ye(o):Ge,h):c!==Ge},h.interpolate=function(t){return arguments.length?(l=t,u()):l},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,i){return t=n,e=i,u()}}()(t,e)}function en(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}var nn,rn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function sn(t){if(!(e=rn.exec(t)))throw new Error("invalid format: "+t);var e;return new on({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function on(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function an(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function ln(t){return(t=an(Math.abs(t)))?t[1]:NaN}function cn(t,e){var n=an(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}sn.prototype=on.prototype,on.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const un={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return cn(100*t,e)},r:cn,s:function(t,e){var n=an(t,e);if(!n)return t+"";var i=n[0],r=n[1],s=r-(nn=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+an(t,Math.max(0,e+s-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function hn(t){return t}var dn,pn,fn,mn=Array.prototype.map,gn=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function vn(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?hn:(e=mn.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var r=t.length,s=[],o=0,a=e[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),s.push(t.substring(r-=a,r+a)),!((l+=a+1)>i));)a=e[o=(o+1)%e.length];return s.reverse().join(n)}),r=void 0===t.currency?"":t.currency[0]+"",s=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?hn:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(mn.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"-":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=sn(t)).fill,n=t.align,h=t.sign,d=t.symbol,p=t.zero,f=t.width,m=t.comma,g=t.precision,v=t.trim,y=t.type;"n"===y?(m=!0,y="g"):un[y]||(void 0===g&&(g=12),v=!0,y="g"),(p||"0"===e&&"="===n)&&(p=!0,e="0",n="=");var _="$"===d?r:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",w="$"===d?s:/[%p]/.test(y)?l:"",b=un[y],S=/[defgprs%]/.test(y);function E(t){var r,s,l,d=_,E=w;if("c"===y)E=b(t)+E,t="";else{var x=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:b(Math.abs(t),g),v&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),x&&0==+t&&"+"!==h&&(x=!1),d=(x?"("===h?h:c:"-"===h||"("===h?"":h)+d,E=("s"===y?gn[8+nn/3]:"")+E+(x&&"("===h?")":""),S)for(r=-1,s=t.length;++r<s;)if(48>(l=t.charCodeAt(r))||l>57){E=(46===l?o+t.slice(r+1):t.slice(r))+E,t=t.slice(0,r);break}}m&&!p&&(t=i(t,1/0));var C=d.length+t.length+E.length,M=C<f?new Array(f-C+1).join(e):"";switch(m&&p&&(t=i(M+t,M.length?f-E.length:1/0),M=""),n){case"<":t=d+t+E+M;break;case"=":t=d+M+t+E;break;case"^":t=M.slice(0,C=M.length>>1)+d+t+E+M.slice(C);break;default:t=M+d+t+E}return a(t)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),E.toString=function(){return t+""},E}return{format:h,formatPrefix:function(t,e){var n=h(((t=sn(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(ln(e)/3))),r=Math.pow(10,-i),s=gn[8+i/3];return function(t){return n(r*t)+s}}}}function yn(t,e,n,i){var r,s=function(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),s=i/r;return s>=$t?r*=10:s>=Gt?r*=5:s>=Xt&&(r*=2),e<t?-r:r}(t,e,n);switch((i=sn(null==i?",f":i)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ln(e)/3)))-ln(Math.abs(t)))}(s,o))||(i.precision=r),fn(i,o);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,ln(e)-ln(t))+1}(s,Math.max(Math.abs(t),Math.abs(e))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=function(t){return Math.max(0,-ln(Math.abs(t)))}(s))||(i.precision=r-2*("%"===i.type))}return pn(i)}function _n(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var i,r,s,o,a=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((i=e<t)&&(r=t,t=e,e=r),0===(o=Yt(t,e,n))||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),s=new Array(r=Math.ceil(e-t+1));++a<r;)s[a]=(t+a)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),s=new Array(r=Math.ceil(t-e+1));++a<r;)s[a]=(t-a)/o;return i&&s.reverse(),s}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var i=e();return yn(i[0],i[i.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,r=e(),s=0,o=r.length-1,a=r[s],l=r[o];return l<a&&(i=a,a=l,l=i,i=s,s=o,o=i),(i=Yt(a,l,n))>0?i=Yt(a=Math.floor(a/i)*i,l=Math.ceil(l/i)*i,n):i<0&&(i=Yt(a=Math.ceil(a*i)/i,l=Math.floor(l*i)/i,n)),i>0?(r[s]=Math.floor(a/i)*i,r[o]=Math.ceil(l/i)*i,e(r)):i<0&&(r[s]=Math.ceil(a*i)/i,r[o]=Math.floor(l*i)/i,e(r)),t},t}dn=vn({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),pn=dn.format,fn=dn.formatPrefix;const wn={select:function(t){return"string"==typeof t?new qt([[document.querySelector(t)]],[document.documentElement]):new qt([[t]],Bt)},scaleLinear:function t(){var e=tn(Ge,Ge);return e.copy=function(){return Qe(e,t())},en.apply(e,arguments),_n(e)},extent:function(t,e){var n,i,r,s=t.length,o=-1;if(null==e){for(;++o<s;)if(null!=(n=t[o])&&n>=n)for(i=r=n;++o<s;)null!=(n=t[o])&&(i>n&&(i=n),r<n&&(r=n))}else for(;++o<s;)if(null!=(n=e(t[o],o,t))&&n>=n)for(i=r=n;++o<s;)null!=(n=e(t[o],o,t))&&(i>n&&(i=n),r<n&&(r=n));return[i,r]}};function bn(t,e,n){return 1/Math.sqrt(2*Math.PI)*Math.exp(-Math.pow(t-e,2)/(2*Math.pow(n,2)))}function Sn(t,e,n){return Math.abs((t-e)/n)>1?0:3/4*(1-Math.pow((t-e)/n,2))}function En(t,e,n){return 1/(Math.exp((t-e)/n)+Math.exp(-(t-e)/n))}function xn(t,e,n){return Math.abs((t-e)/n)>1?0:.5}function Cn(t,e,n){return Math.abs((t-e)/n)>1?0:1-Math.abs((t-e)/n)}function Mn(t,e,n){return Math.abs((t-e)/n)>1?0:15/16*Math.pow(1-Math.pow((t-e)/n,2),2)}function kn(t,e,n){return Math.abs((t-e)/n)>1?0:35/32*Math.pow(1-Math.pow((t-e)/n,2),3)}function Tn(t,e,n){return Math.abs((t-e)/n)>1?0:Math.PI/4*Math.cos(Math.PI/2*((t-e)/n))}function In(t,e,n){return Math.abs((t-e)/n)>1?0:70/81*Math.pow(1-Math.pow(Math.abs((t-e)/n),3),3)}function Nn(t,e,n){var i=Math.abs((e-t)/n);return.5*Math.exp(-i/Math.SQRT2)*Math.sin(i/Math.SQRT2+Math.PI/4)}const An={smooth:{}};An.smooth.kernel2=function(){var t,e,n=[],i={Uniform:xn,Triangle:Cn,Epanechnikov:Sn,Quartic:Mn,Triweight:kn,Logistic:En,Cosine:Tn,Gaussian:bn,Tricube:In,Silverman:Nn},r=.001,s=[],o=[],a="Gaussian",l=function(t){return t[0]},c=function(t){return t[1]};function u(){var u;u=o.map((function(t){return[l(t),c(t)]}));var h=[];if("number"==typeof s)for(t=0;t<u.length;t++)h.push(s);else{if("object"!=typeof s||!Array.isArray(s))throw console.log(s),new Error("Invalid scale parameter");if(s.length===u.length)h=s.slice();else{var d=0;for(t=0;t<u.length;t++)h.push(s[d]),t<s.length?d++:d=0}}for(t=0;t<u.length;t++){var p=0,f=0,m=0,g=i[a](u[t][0],u[t][0],h[t]);for(p+=g*u[t][1],f+=g,e=t-1;e>-1&&!((m=i[a](u[t][0],u[e][0],h[t]))/g<r);e--)p+=m*u[e][1],f+=m;for(e=t+1;e<u.length&&!((m=i[a](u[t][0],u[e][0],h[t]))/g<r);e++)p+=m*u[e][1],f+=m;n.push([u[t][0],p/f])}}return u.scale=function(t){return arguments.length?(s=t,u):s},u.kernel=function(t){if(!arguments.length)return a;if("function"!=typeof i[t])throw new Error("Invalid kernel");return a=t,u},u.x=function(t){return arguments.length?(l=t,u):l},u.y=function(t){return arguments.length?(c=t,u):c},u.output=function(){return n},u.diff=function(t){return arguments.length?(r=t,u):r},u.data=function(t){return o=t,u},u};var Rn=n(961),Ln=n.n(Rn);const On={container:t=>JSON.parse(localStorage.getItem(t))||[],unshift:(t,e)=>{let n=On.container(t);n=n.filter(t=>t!==e),n.unshift(e),localStorage.setItem(t,JSON.stringify(n))},remove:(t,e)=>{let n=On.container(t);n=n.filter(t=>t!==e),localStorage.removeItem(e),localStorage.setItem(t,JSON.stringify(n))},add:(t,e,n)=>{let i=On.container(t);if(i.unshift(e),i.length>3){let t=i.pop();localStorage.removeItem(t)}localStorage.setItem(t,JSON.stringify(i)),On.set(e,n)},set:(t,e)=>{let n=e;"toJSON"in e&&(n=e.toJSON()),localStorage.setItem(t,Ln().compressToUTF16(JSON.stringify(n)))},get:t=>{let e=localStorage.getItem(t);return null!=e?JSON.parse(Ln().decompressFromUTF16(e)):e}};var Dn=n(560),Pn=n.n(Dn);class Un{constructor({elevation:t,grade:e,smoothedGrade:n,distance:i,heading:r,climb:s,opposite:o,location:a}){this.elevation=t,this.grade=e,this.smoothedGrade=n,this.distance=i,this.heading=r,this.climb=s,this.opposite=o,a instanceof google.maps.LatLng?this.location=a:this.location=new google.maps.LatLng(a.lat,a.lng)}toJSON(){let{elevation:t,grade:e,smoothedGrade:n,distance:i,heading:r,climb:s,opposite:o}=this;return{elevation:t,grade:e,smoothedGrade:n,distance:i,heading:r,climb:s,opposite:o,location:this.location.toJSON()}}static fromJSON(t){return new Un(t)}}class Bn{constructor(t){this.fileBody=t,this.md5=Pn()(t),this.points=[]}expandPointsWithGradeAndHeading(){for(let t=0;t<this.points.length;t++){let e=this.points[t];if(t<this.points.length-1){let n=this.points[t+1];e.heading=google.maps.geometry.spherical.computeHeading(e.location,n.location);let i=google.maps.geometry.spherical.computeDistanceBetween(e.location,n.location),r=n.elevation-e.elevation;e.distance=i,e.grade=r/i*100,e.opposite=r,e.climb=r}else e.distance=0,e.heading=0,e.grade=0,e.opposite=0,e.climb=0}let t=this.points.map((t,e)=>[e,t.grade]),e=An.smooth.kernel2().kernel("Gaussian").data(t).scale(2);e();let n=e.output();for(let t=0;t<this.points.length;t++)this.points[t].smoothedGrade=n[t][1],(this.points[t].smoothedGrade<.95||this.points[t].climb<0)&&(this.points[t].climb=0)}async expandPointsWithElevation(t){let e=0;for(;e<t.length;){e>0&&await a(4e3);let n=[],i=0,r=0;for(let s=e;s<t.length;s++){let e=t[s],o=0;if(s<t.length-1){let n=t[s+1];o=google.maps.geometry.spherical.computeDistanceBetween(e.location,n.location)}if(i+=o,r+=1,!(i<=10240&&r<512)){r-=1,i-=o;break}n.push(e.location)}let o={path:n,samples:Math.ceil(i/20)},l=(await s(o)).map(t=>new Un({elevation:t.elevation,location:t.location}));Array.prototype.push.apply(this.points,l),e=r+e}}async create(){let t="gpx-cache-"+this.md5,e=On.get(t);if(null!=e)On.unshift("gpx-cache",t),this.points=e.map(t=>Un.fromJSON(t));else{let e=(new DOMParser).parseFromString(this.fileBody,"text/xml"),n=Array.from(e.documentElement.getElementsByTagName("trkpt")).map(t=>{let e=parseFloat(t.getAttribute("lat")),n=parseFloat(t.getAttribute("lon"));return new Un({location:{lat:e,lng:n}})});await this.expandPointsWithElevation(n),this.expandPointsWithGradeAndHeading(),On.add("gpx-cache",t,this.points)}return this.points}}n(959);class qn{constructor({id:t,powerMeter:e,heartMeter:n,cadenceMeter:i,riderWeight:r,unit:s,routeName:o="",history:a=[],points:l,ridingState:c}){this.id=t,this.powerMeter=e,this.heartMeter=n,this.cadenceMeter=i,this.riderWeight=r,this.unit=s,this.routeName=o,this.history=a,this.points=l,this.ridingState=c,this.routeCompleted=!1,this.powerSamples=[],void 0!==this.id&&null!==this.id||(this.id=(new Date).getTime()),"string"==typeof this.riderWeight&&(this.riderWeight=parseInt(this.riderWeight)),void 0!==this.ridingState&&null!==this.ridingState||(this.ridingState={pointIdx:0,point:this.points[0],pointPct:0,lastSampleTime:new Date,location:this.points[0].location,elevation:this.points[0].elevation,average_grade:0,mapMode:"SV",watts:0,rpm:void 0,bpm:void 0,speed:0,distance:0,climb:0,elapsed:0})}async init(){this.miniMap=new google.maps.Map(document.getElementById("tracker"),{center:this.ridingState.point.location,zoom:14,fullscreenControl:!1,zoomControl:!0,mapTypeId:google.maps.MapTypeId.TERRAIN});let t=this.points.map(t=>({lat:t.location.lat(),lng:t.location.lng()}));new google.maps.Polyline({path:t,geodesic:!0,strokeColor:"#0c7ac9",strokeOpacity:1,strokeWeight:2}).setMap(this.miniMap),this.fullMap=new google.maps.Map(document.getElementById("map-view"),{center:this.ridingState.point.location,zoom:18,fullscreenControl:!1,zoomControl:!0,mapTypeId:google.maps.MapTypeId.TERRAIN}),new google.maps.Polyline({path:t,geodesic:!0,strokeColor:"#0c7ac9",strokeOpacity:1,strokeWeight:2}).setMap(this.fullMap),this.fullMarker=new google.maps.Marker({position:this.ridingState.point.location,map:this.fullMap,icon:"./images/here.png"}),this.fullMarker.setMap(this.fullMap);let e=this.streetViewPanoramaInit(this.ridingState.point.location,this.ridingState.point.heading);this.miniMap.setStreetView(e),this.zoomSvg=wn.select("#ui-elevation").append("svg").attr("id","ui-elevation-svg").attr("x",0).attr("y",0).attr("viewBox","0 0 150 60").attr("preserveAspectRatio","none"),this.drawHeightMap(),this.powerMeter.addListener("power",t=>this.collectPower(t)),this.heartMeter&&this.heartMeter.addListener("hr",t=>this.collectHR(t)),this.cadenceMeter&&this.cadenceMeter.addListener("cadence",t=>this.collectCadence(t));let n=await function(t){return new Promise((function(e,n){i.geocode({location:t},(function(t,i){"OK"===i?e(t):n(new Error(i))}))}))}(this.points[0].location),r=["street_address","route","intersection","postal_code"];for(let t of n){let e="";if(t.types.length>0&&(e=t.types[0]),!r.includes(e)){this.routeName=t.formatted_address;break}}}collectPower(t){this.powerSamples.push(t)}collectHR(t){this.ridingState.bpm=t}collectCadence(t){this.ridingState.rpm=t}streetViewPanoramaInit(t,e){let n=document.getElementById("street-view");n.innerHTML="";let i=new google.maps.StreetViewPanorama(n,{visible:!0,fullscreenControl:!1,clickToGo:!1,addressControl:!1,panControl:!1,zoomControl:!1,linksControl:!1,pov:{heading:e,pitch:0},position:t});return i.addListener("status_changed",()=>{i.setPov({heading:this.ridingState.point.heading,pitch:0})}),i}drawHeightMap(){this.fullSvg=wn.select("#ui-heightmap").append("svg").attr("id","ui-heightmap-svg").attr("x",0).attr("y",0).attr("viewBox","0 0 150 37.5").attr("preserveAspectRatio","none"),this.fullSvgData=[];for(let t=0;t<this.points.length;t++)this.fullSvgData.push([t,this.points[t].elevation]);let[t,e]=wn.extent(this.fullSvgData,t=>t[1]);e-t<125&&(e=t+125);const n=wn.scaleLinear().domain([e,t]).range([6,33]),i=wn.scaleLinear().domain([0,this.points.length-1]).range([0,150]);this.fullSvgData=this.fullSvgData.map(t=>[i(t[0]),n(t[1])]),this.fullSvgData.push([150,37.5]),this.fullSvgData.push([0,37.5]),this.fullSvgData.push([0,this.fullSvgData[0][1]]),this.fullSvg.selectAll("polygon").data([this.fullSvgData]).attr("points",t=>t.map(t=>[t[0],t[1]].join(",")).join(" ")).enter().append("polygon").attr("points",t=>t.map(t=>[t[0],t[1]].join(",")).join(" ")).attr("fill","#31A3CC").attr("stroke","#31A3CC").attr("stroke-width","1")}updateGraphs(){let t=new Array(101);for(let e=0;e<t.length;e++){let n=e-50+this.ridingState.pointIdx;n<0&&(n=0),n>=this.points.length&&(n=this.points.length-1),t[e]=[e,this.points[n].elevation]}let[e,n]=wn.extent(t,t=>t[1]);n-e<50&&(n=e+50);const i=wn.scaleLinear().domain([n,e]).range([15,40.8]),r=wn.scaleLinear().domain([0,100]).range([0,150]);t=t.map(t=>[r(t[0]),i(t[1])]),t.push([150,60]),t.push([0,60]),t.push([0,t[0][1]]),this.zoomSvg.selectAll("polygon").data([t]).attr("points",t=>t.map(t=>[t[0],t[1]].join(",")).join(" ")).enter().append("polygon").attr("points",t=>t.map(t=>[t[0],t[1]].join(",")).join(" ")).attr("fill","#31A3CC").attr("stroke","#31A3CC").attr("stroke-width","1"),this.zoomSvg.selectAll("image").data([t[51]]).attr("x",t=>t[0]-7.5).attr("y",t=>t[1]-15).attr("width","15").attr("height","15").attr("xlink:href","./images/marker.svg").enter().append("image").attr("x",t=>{t[0]}).attr("y",t=>{t[1]}),this.fullSvg.selectAll("image").data([this.fullSvgData[this.ridingState.pointIdx]]).attr("x",t=>t[0]-3).attr("y",t=>t[1]-6).attr("width","6").attr("height","6").attr("xlink:href","./images/marker.svg").enter().append("image").attr("x",t=>{t[0]}).attr("y",t=>{t[1]})}async updatePosition(){let t=0;for(;!this.routeCompleted;){this.powerSamples.length&&(this.ridingState.watts=this.powerSamples.reduce((t,e)=>t+e,0)/this.powerSamples.length,this.powerSamples.length=0);let e=new Date,n=(e-this.ridingState.lastSampleTime)/1e3;this.ridingState.lastSampleTime=e;let i=1,s=0,o=0;for(;i>0;){let t=this.speedFromPower(this.ridingState.watts,this.ridingState.point.smoothedGrade,this.ridingState.point.elevation),e=this.ridingState.speed+.2*(t-this.ridingState.speed);this.ridingState.watts<50&&e<.447&&(e=0);let r=e*n*i,a=this.ridingState.point.distance-this.ridingState.point.distance*this.ridingState.pointPct;if(r>a){let t=a/r;if(o+=this.ridingState.point.smoothedGrade*t,i-=i*t,this.ridingState.pointIdx+=1,this.ridingState.pointPct=0,this.ridingState.climb+=this.ridingState.point.climb,this.ridingState.point=this.points[this.ridingState.pointIdx],s+=a,this.ridingState.pointIdx>=this.points.length)break}else{let t=i;o+=this.ridingState.point.smoothedGrade*t,i=0,0!==a?(this.ridingState.pointPct=1-(a-r)/this.ridingState.point.distance,s+=r):this.ridingState.pointPct=0}}if(this.ridingState.pointIdx>=this.points.length)break;if(this.ridingState.average_grade=o,this.ridingState.distance+=s,this.ridingState.elevation=this.ridingState.point.elevation+this.ridingState.point.opposite*this.ridingState.pointPct,this.ridingState.speed=s/n,this.ridingState.speed>0&&(this.ridingState.elapsed+=n),this.ridingState.location=google.maps.geometry.spherical.interpolate(this.ridingState.point.location,this.points[this.ridingState.pointIdx+1].location,this.ridingState.pointPct),this.history.push({time:e,location:this.ridingState.location,power:this.ridingState.watts,elevation:this.ridingState.elevation,hr:this.ridingState.bpm,cad:this.ridingState.rpm}),t%5==0){let t=this.miniMap.getStreetView();try{let e=await r(this.ridingState.location,50);"profileUrl"in e.location||("MV"===this.ridingState.mapMode&&(document.getElementById("map-view").style.display="none",document.getElementById("tracker").style.display="block",document.getElementById("street-view").style.display="block",t.setVisible(!0),google.maps.event.trigger(t,"resize"),google.maps.event.trigger(this.miniMap,"resize")),this.miniMap.panTo(this.ridingState.location),"MV"===this.ridingState.mapMode?t.setPano(e.location.pano):t.setPosition(this.ridingState.location),this.ridingState.mapMode="SV")}catch(e){"SV"===this.ridingState.mapMode&&(t.setVisible(!1),document.getElementById("street-view").style.display="none",document.getElementById("tracker").style.display="none",document.getElementById("map-view").style.display="block",google.maps.event.trigger(this.fullMap,"resize")),this.ridingState.mapMode="MV",this.fullMap.panTo(this.ridingState.location),this.fullMarker.setPosition(this.ridingState.location)}}t%30==0&&Promise.resolve().then(()=>{On.set(this.cacheName(),this)}),this.updateGraphs(),t+=1,await a(1e3)}this.routeCompleted=!0}speedFromPower(t,e,n){let i=1e3*Math.exp(-n/7e3),r=function(t,e){var n=-1e3,i=1e3,r=0,s=p(r,e),o=0;do{if(Math.abs(s-t)<1e-6)break;s>t?i=r:n=r,s=p(r=(i+n)/2,e)}while(o++<100);return r}(t,{units:"metric",rp_wr:this.riderWeight*("imperial"===this.unit?.453592:1),rp_wb:8,rp_a:.65,rp_cd:.63,rp_dtl:4,ep_crr:.005,ep_g:e,ep_rho:d(23.8889,i,7.5)});return r*=.277778,r}async updateUI(){for(;!this.routeCompleted;){let t,e=this.ridingState.elapsed.toFixed(),n=Math.floor(e/3600),i=Math.floor((e-3600*n)/60),r=e-3600*n-60*i;i<10&&(i="0"+i),r<10&&(r="0"+r),t=0!==n?n+":"+i+":"+r:i+":"+r;let s=this.ridingState.distance*("imperial"===this.unit?621371e-9:.001);s=s>=100?s.toFixed():s.toFixed(1);let o=this.ridingState.average_grade.toFixed(1);"-0"!==o&&"-0.0"!==o||(o="0.0");let l=document.getElementById("grade-unit-icon");o>=0?l.classList.contains("fa-long-arrow-down")&&(l.classList.remove("fa-long-arrow-down"),l.classList.add("fa-long-arrow-up")):l.classList.contains("fa-long-arrow-up")&&(l.classList.remove("fa-long-arrow-up"),l.classList.add("fa-long-arrow-down"));let c=this.ridingState.watts;c=null!=c?c.toFixed():"--";let u=this.ridingState.bpm;u=null!=u?u.toFixed():"--";let h=this.ridingState.rpm;h=null!=h?h.toFixed():"--",document.getElementById("watts").innerHTML=c,document.getElementById("heart").innerHTML=u,document.getElementById("cadence").innerHTML=h,document.getElementById("speed").innerHTML=(this.ridingState.speed*("imperial"===this.unit?2.23694:3.6)).toFixed(),document.getElementById("distance").innerHTML=s,document.getElementById("climb").innerHTML=(this.ridingState.climb*("imperial"===this.unit?3.28084:1)).toFixed(),document.getElementById("time").innerHTML=t,document.getElementById("grade").innerHTML=o,document.getElementById("distance-unit-value").innerHTML="imperial"===this.unit?"mi":"&nbsp;km",document.getElementById("speed-unit-value").innerHTML="imperial"===this.unit?"mph":"kph",document.getElementById("climb-container-value").innerHTML="imperial"===this.unit?"ft":"m",await a(1e3)}}async stravaExport(){let t=document.getElementById("btn-export-strava");if(t.classList.contains("disabled"))return;t.classList.add("disabled"),t.innerHTML="Exporting";let e=document.getElementById("input-ride-name"),n=e.value,i=document.getElementById("strava-gpx-template").innerHTML,r=this.history.map(t=>({lat:t.location.lat(),lng:t.location.lng(),elevation:t.elevation.toFixed(5),time:l(t.time),power:t.power,hr:t.hr,cad:t.cad})),s=L.render(i,{export_time:l(new Date),export_name:n,points:r}),c=u(),d=new FormData;d.set("client_id",o.STRAVA_CLIENT_ID),d.set("client_secret",o.STRAVA_CLIENT_SECRET),d.set("refresh_token",c.refresh_token),d.set("grant_type","refresh_token");let p=await fetch("https://www.strava.com/oauth/token",{method:"POST",body:d});if(!p.ok){let t=await p.json(),n=t.message,i=JSON.stringify(t.errors),r=document.getElementById("strva-post-error");return r.innerHTML=`<p>An error occurred while authorizing with Strava</p><p>${n} - ${i}</p><br /><br />`,r.style.display="block",void(e.style.display="none")}let f=await p.json();c.access_token=f.access_token,c.refresh_token=f.refresh_token,h(c);let m=new File([s],"import_to_strava.gpx",{type:"text/xml"}),g=new FormData;g.set("activity_type","virtualride"),g.set("name",n),g.set("data_type","gpx"),g.set("file",m);let v=new Headers;v.set("Authorization","Bearer "+c.access_token);let y=await fetch("https://www.strava.com/api/v3/uploads",{method:"POST",headers:v,body:g});if(!y.ok){let t=await y.json(),n=t.message,i=JSON.stringify(t.errors),r=document.getElementById("strva-post-error");return r.innerHTML=`<p>An error occurred while uploading to Strava</p><p>${n} - ${i}</p><br /><br />`,r.style.display="block",void(e.style.display="none")}let _=(await y.json()).id;for(;;){let t=await fetch("https://www.strava.com/api/v3/uploads/"+_,{headers:v});if(!t.ok){let n=await t.json(),i=n.message,r=JSON.stringify(n.errors),s=document.getElementById("strva-post-error");return s.innerHTML=`<p>An error occurred while waiting on upload to Strava</p><p>${i} - ${r}</p><br /><br />`,s.style.display="block",void(e.style.display="none")}if((await t.json()).activity_id)break;await a(4e3)}this.routeCompleted=!0,On.remove("route-progress",this.cacheName()),t.innerHTML="Done!"}showFinalizeUI(t){if(document.getElementById("ui-finalize-container").style.display="block",document.getElementById("ui-finalize-label").innerHTML=t,c()){let t=new Date,e="GPedal - ";this.routeName?e+=this.routeName:e+=t.getMonth()+1+"/"+t.getDate();let n=document.getElementById("input-ride-name");n.value=e,n.style.display="block";let i=document.getElementById("btn-export-strava");i.style.display="block",i.onclick=t=>{t.preventDefault(),this.stravaExport().catch(t=>{console.log("Error: ",t)})}}}cacheName(){return"route-progress-"+this.id}toJSON(){let{history:t,id:e,points:n,riderWeight:i,ridingState:r,routeName:s,unit:o}=this;return t=t.map(t=>((t=Object.assign({},t)).location=t.location.toJSON(),t.time=t.time.toJSON(),t)),n=n.map(t=>t.toJSON()),r=Object.assign({},r),r.lastSampleTime=r.lastSampleTime.toJSON(),r.location=r.location.toJSON(),r.point=r.point.toJSON(),r.bpm=void 0,r.rpm=void 0,r.speed=0,r.watts=0,{history:t,id:e,points:n,riderWeight:i,ridingState:r,routeName:s,unit:o}}static fromJSON(t){for(let e of t.history)e.location=new google.maps.LatLng(e.location.lat,e.location.lng),e.time=new Date(e.time);return t.points=t.points.map(t=>Un.fromJSON(t)),t.ridingState.lastSampleTime=new Date(t.ridingState.lastSampleTime),t.ridingState.location=new google.maps.LatLng(t.ridingState.location.lat,t.ridingState.location.lng),t.ridingState.point=Un.fromJSON(t.ridingState.point),new qn(t)}static transitionUI(){document.getElementById("configure-container").style.display="none",document.getElementById("app-container").style.display="block"}}var jn=n(965),Fn=n.n(jn);let Hn=["getInt16",2,!0],zn=["getUint16",2,!0],Vn=["getUint32",4,!0],Wn=[[0,[[Hn,"instantaneous_power"]]],[1,[[["getUint8",1],"pedal_power_balance"]]],[2,[]],[4,[[zn,"accumulated_torque"]]],[8,[]],[16,[[Vn,"cumulative_wheel_revolutions"],[zn,"last_wheel_event_time"]]],[32,[[zn,"cumulative_crank_revolutions"],[zn,"last_crank_event_time"]]],[64,[[Hn,"maximum_force_magnitude"],[Hn,"minimum_force_magnitude"]]],[128,[[Hn,"maximum_torque_magnitude"],[Hn,"minimum_torque_magnitude"]]],[256,[[["getUint8",3],"maximum_minimum_angle"]]],[512,[[zn,"top_dead_spot_angle"]]],[1024,[[zn,"bottom_dead_spot_angle"]]],[2048,[[zn,"accumulated_energy"]]],[4096,[]]],Jn=[[1,[[Vn,"cumulative_wheel_revolutions"],[zn,"last_wheel_event_time"]]],[2,[[zn,"cumulative_crank_revolutions"],[zn,"last_crank_event_time"]]]],$n={1:"garmin",2:"garmin_fr405_antfs",3:"zephyr",4:"dayton",5:"idt",6:"srm",7:"quarq",8:"ibike",9:"saris",10:"spark_hk",11:"tanita",12:"echowell",13:"dynastream_oem",14:"nautilus",15:"dynastream",16:"timex",17:"metrigear",18:"xelic",19:"beurer",20:"cardiosport",21:"a_and_d",22:"hmm",23:"suunto",24:"thita_elektronik",25:"gpulse",26:"clean_mobile",27:"pedal_brain",28:"peaksware",29:"saxonar",30:"lemond_fitness",31:"dexcom",32:"wahoo_fitness",33:"octane_fitness",34:"archinoetics",35:"the_hurt_box",36:"citizen_systems",37:"magellan",38:"osynce",39:"holux",40:"concept2",42:"one_giant_leap",43:"ace_sensor",44:"brim_brothers",45:"xplova",46:"perception_digital",47:"bf1systems",48:"pioneer",49:"spantec",50:"metalogics",51:"4iiiis",52:"seiko_epson",53:"seiko_epson_oem",54:"ifor_powell",55:"maxwell_guider",56:"star_trac",57:"breakaway",58:"alatech_technology_ltd",59:"mio_technology_europe",60:"rotor",61:"geonaute",62:"id_bike",63:"specialized",64:"wtek",65:"physical_enterprises",66:"north_pole_engineering",67:"bkool",68:"cateye",69:"stages_cycling",70:"sigmasport",71:"tomtom",72:"peripedal",73:"wattbike",76:"moxy",77:"ciclosport",78:"powerbahn",79:"acorn_projects_aps",80:"lifebeam",81:"bontrager",82:"wellgo",83:"scosche",84:"magura",85:"woodway",86:"elite",87:"nielsen_kellerman",88:"dk_city",89:"tacx",90:"direction_technology",91:"magtonic",92:"1partcarbon",93:"inside_ride_technologies",94:"sound_of_motion",95:"stryd",96:"icg",97:"MiPulse",98:"bsx_athletics",99:"look",100:"campagnolo_srl",101:"body_bike_smart",102:"praxisworks",103:"limits_technology",104:"topaction_technology",105:"cosinuss",106:"fitcare",107:"magene",108:"giant_manufacturing_co",109:"tigrasport",110:"salutron",111:"technogym",112:"bryton_sensors",113:"latitude_limited",114:"soaring_technology",115:"igpsport",116:"thinkrider",117:"gopher_sport",118:"waterrower",255:"development",257:"healthandlife",258:"lezyne",259:"scribe_labs",260:"zwift",261:"watteam",262:"recon",263:"favero_electronics",264:"dynovelo",265:"strava",266:"precor",267:"bryton",268:"sram",269:"navman",270:"cobi",271:"spivi",272:"mio_magellan",273:"evesports",274:"sensitivus_gauge",275:"podoon",276:"life_time_fitness",277:"falco_e_motors",278:"minoura",279:"cycliq",280:"luxottica",281:"trainer_road",282:"the_sufferfest",283:"fullspeedahead",284:"virtualtraining",285:"feedbacksports",286:"omata",287:"vdo",5759:"actigraphcorp"};class Gn{getData(t){let e,n=0;16===this.mask_size?(e=t.getUint16(0,!0),n+=2):(e=t.getUint8(0),n+=1);let i=[];if(0===this.fields[0][0])for(let t of this.fields[0][1])i.push(t);for(let[t,n]of this.fields)if(e&t)for(let t of n)i.push(t);let r={};for(let e of i){var[[s,o,a],l]=e;let i;i=a?t[s](n,a):t[s](n),r[l]=i,n+=o}return r}}class Xn extends Gn{constructor(){super(),this.fields=Jn,this.mask_size=8}}class Yn extends Gn{constructor(){super(),this.fields=Wn,this.mask_size=16}}class Kn{constructor(){this.listeners={},this.timeoutID=void 0,this.milliTimeout=8e3}clearValueOnTimeout(t){void 0!==this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=setTimeout(()=>{if(this.timeoutID=void 0,t.constructor===Array)for(let e of t)this.dispatch(e,0);else this.dispatch(t,0)},this.milliTimeout)}addListener(t,e){t in this.listeners||(this.listeners[t]=[]),this.listeners[t].push(e)}dispatch(t,e){t in this.listeners||(this.listeners[t]=[]);for(let n of this.listeners[t])n(e)}}class Zn extends Kn{constructor(t,e,n,i){super(),this.device=t,this.server=e,this.service=n,this.characteristic=i,this.name=this.device.name,this.id=this.device.id,this.listening=!1,this.device.addEventListener("gattserverdisconnected",t=>{this.gattserverdisconnected(t).catch(t=>{console.log("Error: ",t)})})}async gattserverdisconnected(t){console.log("Reconnecting"),this.server=await this.device.gatt.connect(),this.service=await this.server.getPrimaryService(this.serviceId),this.characteristic=await this.service.getCharacteristic(this.characteristicId),this.listening&&(this.listening=!1,this.listen())}}class Qn extends Zn{constructor(t,e,n,i){super(t,e,n,i),this.serviceId=6168,this.characteristicId=10851,this.parser=new Yn,this.lastCrankRevolutions=0,this.lastCrankTime=0,this.lastWheelRevolutions=0,this.lastWheelTime=0}listen(){this.listening||(this.characteristic.addEventListener("characteristicvaluechanged",t=>{let e=this.parser.getData(t.target.value),n=e.instantaneous_power,i=e.cumulative_crank_revolutions,r=e.last_crank_event_time,s=e.cumulative_wheel_revolutions,o=e.last_wheel_event_time;this.lastCrankTime>r&&(this.lastCrankTime=this.lastCrankTime-65536),this.lastCrankRevolutions>i&&(this.lastCrankRevolutions=this.lastCrankRevolutions-65536);let a=i-this.lastCrankRevolutions,l=(r-this.lastCrankTime)/1024,c=0;if(l>0&&(c=a/l*60),this.lastCrankRevolutions=i,this.lastCrankTime=r,void 0!==s&&void 0!==o){this.lastWheelTime>o&&(this.lastWheelTime=this.lastWheelTime-65536),this.lastWheelRevolutions>s&&(this.lastWheelRevolutions=this.lastWheelRevolutions-65536);let t=s-this.lastWheelRevolutions,e=(o-this.lastWheelTime)/1024,n=0;e>0&&(n=t/e*60),this.lastWheelRevolutions=s,this.lastWheelTime=o,this.dispatch("wheelrpm",n)}this.dispatch("power",n),this.dispatch("cadence",c),this.clearValueOnTimeout(["power","cadence","wheelrpm"])}),this.characteristic.startNotifications(),this.listening=!0)}}class ti extends Zn{constructor(t,e,n,i){super(t,e,n,i),this.serviceId=6168,this.characteristicId=10851,this.parser=new Yn}listen(){this.listening||(this.characteristic.addEventListener("characteristicvaluechanged",t=>{let e=this.parser.getData(t.target.value).instantaneous_power;this.dispatch("power",e),this.clearValueOnTimeout("power")}),this.characteristic.startNotifications(),this.listening=!0)}}class ei extends Zn{constructor(t,e,n,i){super(t,e,n,i),this.serviceId=6166,this.characteristicId=10843,this.parser=new Xn,this.lastCrankRevolutions=0,this.lastCrankTime=0,this.lastWheelRevolutions=0,this.lastWheelTime=0}listen(){this.listening||(this.characteristic.addEventListener("characteristicvaluechanged",t=>{let e=this.parser.getData(t.target.value),n=e.cumulative_crank_revolutions,i=e.last_crank_event_time,r=e.cumulative_wheel_revolutions,s=e.last_wheel_event_time;if(void 0!==n&&void 0!==i){this.lastCrankTime>i&&(this.lastCrankTime=this.lastCrankTime-65536),this.lastCrankRevolutions>n&&(this.lastCrankRevolutions=this.lastCrankRevolutions-65536);let t=n-this.lastCrankRevolutions,e=(i-this.lastCrankTime)/1024,r=0;e>0&&(r=t/e*60),this.lastCrankRevolutions=n,this.lastCrankTime=i,this.dispatch("cadence",r)}if(void 0!==r&&void 0!==s){this.lastWheelTime>s&&(this.lastWheelTime=this.lastWheelTime-65536),this.lastWheelRevolutions>r&&(this.lastWheelRevolutions=this.lastWheelRevolutions-65536);let t=r-this.lastWheelRevolutions,e=(s-this.lastWheelTime)/1024,n=0;e>0&&(n=t/e*60),this.lastWheelRevolutions=r,this.lastWheelTime=s,this.dispatch("wheelrpm",n)}this.clearValueOnTimeout(["cadence","wheelrpm"])}),this.characteristic.startNotifications(),this.listening=!0)}}class ni extends Zn{constructor(t,e,n,i){super(t,e,n,i),this.serviceId=6157,this.characteristicId=10807}listen(){this.listening||(this.characteristic.addEventListener("characteristicvaluechanged",t=>{let e=t.target.value.getUint8(1);this.dispatch("hr",e),this.clearValueOnTimeout("hr")}),this.characteristic.startNotifications(),this.listening=!0)}}class ii extends Kn{constructor(){super(),this.listening=!1,this.watts=0,this.id="virtual",this.name="Virtual Power Meter"}listen(){if(!this.listening){document.getElementById("ui-vpower-container").style.display="block";let t=document.getElementById("vpower");t.value=this.watts,t.onchange=e=>{this.watts=parseInt(t.value)},setInterval(()=>{this.dispatch("power",this.watts)},750),this.listening=!0}}}class ri extends Kn{constructor(){super(),this.listening=!1,this.id="cycleopsmagnetopowercurve",this.name="Cycleops Magneto Power Curve"}listen(t){if(!this.listening){let e=t.cadenceMeter;void 0!==e&&(e.addListener("wheelrpm",t=>{let e=2136*t*60/1e6,n=this.Exponential_DoubleAsymptoticExponentialB_model(e);n<0&&(n=0),this.dispatch("power",n),this.clearValueOnTimeout("power")}),this.listening=!0)}}Exponential_DoubleAsymptoticExponentialB_model(t){let e;e=0;return e=-425.5747279901687*(1-Math.exp(.01671978158087617*t))+-73.52558744233421*(1-Math.exp(-.13986922573862917*t)),e}}class si extends Kn{constructor(t,e,n,i){super(),this.type=t,this.manId=e,this.modelNum=n,this.deviceId=i,this.setName()}listen(){}setName(){let t="Unknown";this.manId in $n&&(t=$n[this.manId].split("_").map(t=>t[0].toUpperCase()+t.substr(1)).join(" ")),this.name=t+" - "+this.deviceId}}class oi extends si{constructor(t,e,n,i,r){super(e,n,i,r),this.id=t}antMessage(t){let e=t.Power;void 0!==e&&(this.dispatch("power",e),this.clearValueOnTimeout("power"))}}class ai extends si{constructor(t,e,n,i,r){super(e,n,i,r),this.id=t,this.lastWheelRevolutions=0,this.lastWheelTime=0}antMessage(t){let e=void 0;void 0!==t.Cadence&&(e=t.Cadence),void 0!==t.CalculatedCadence&&(e=t.CalculatedCadence),void 0!==e&&this.dispatch("cadence",e);let n=t.SpeedEventTime,i=t.CumulativeSpeedRevolutionCount;if(void 0!==i&&void 0!==n&&this.lastWheelTime!==n){this.lastWheelTime>n&&(this.lastWheelTime=this.lastWheelTime-65536),this.lastWheelRevolutions>i&&(this.lastWheelRevolutions=this.lastWheelRevolutions-65536);let t=i-this.lastWheelRevolutions,e=(n-this.lastWheelTime)/1024,r=0;e>0&&(r=t/e*60),this.lastWheelRevolutions=i,this.lastWheelTime=n,this.dispatch("wheelrpm",r)}this.clearValueOnTimeout(["cadence","wheelrpm"])}}class li extends si{constructor(t,e,n,i,r){super(e,n,i,r),this.id=t}antMessage(t){let e=t.ComputedHeartRate;void 0!==e&&(this.dispatch("hr",e),this.clearValueOnTimeout("hr"))}}class ci{constructor(t="http://localhost:8000/"){this.url=t,this.listeners={},this.devicesByType={},this.devices={},this.url.startsWith("http")||(this.url="http://"+this.url),this.url.endsWith("/")||(this.url=this.url+"/"),this.meterClasses={hr:li,bike_power:oi,speed_cadence:ai}}addListener(t,e){t in this.listeners||(this.listeners[t]=[]),this.listeners[t].push(e)}dispatch(t,e){t in this.listeners||(this.listeners[t]=[]);for(let n of this.listeners[t])n(e)}scan(){let t=new(Fn().Client)(this.url,{timeout:120,retry:10});t.on("transport:down",t=>{this.dispatch("error",t)}),t.subscribe("/*",t=>{const e=JSON.parse(t.text);let n=[e.type];"bike_power"===e.type&&(e.Cadence||e.CalculatedCadence)&&n.push("speed_cadence");for(let t of n){let n=t+e.DeviceID;if(!(n in this.devicesByType)&&t in this.meterClasses){let i=new this.meterClasses[t](n,t,e.ManId,e.ModelNum,e.DeviceID);e.DeviceID in this.devices||(this.devices[e.DeviceID]=[]),this.devices[e.DeviceID].push(i),this.devicesByType[n]=i,this.dispatch(t,i)}}if(e.DeviceID in this.devices)for(let t of this.devices[e.DeviceID])t.antMessage(e);if((void 0!==e.ManId||void 0!==e.ModelNum)&&e.DeviceID in this.devices)for(let t of this.devices[e.DeviceID]){let n=!1;void 0!==e.ManId&&e.ManId!==t.manId&&(t.manId=e.ManId,n=!0),void 0!==e.ModelNum&&e.ModelNum!==t.modelNum&&(t.modelNum=e.ModelNum,n=!0),n&&(t.setName(),this.dispatch("namechange",t))}})}}class ui extends Kn{constructor(t){super(),this.port=t,this.name="BH BladeZ Bike Meter",this.id="BHBladeZBikeMeter",this.listening=!1,this.inputStream=this.port.readable,this.reader=this.inputStream.getReader(),this.outputStream=this.port.writable,this.initCommandsRaw=[[85,12,1,-1],[85,-69,1,-1],[85,36,1,-1],[85,37,1,-1],[85,38,1,-1],[85,39,1,-1],[85,2,1,-1],[85,3,1,-1],[85,4,1,-1],[85,6,1,-1],[85,31,1,-1],[85,-96,1,-1],[85,-80,1,-1],[85,-78,1,-1],[85,-77,1,-1],[85,-76,1,-1],[85,-75,1,-1],[85,-74,1,-1],[85,-73,1,-1],[85,-72,1,-1],[85,-71,1,-1],[85,-70,1,-1],[85,11,1,-1],[85,24,1,-1],[85,25,1,-1],[85,26,1,-1],[85,27,1,-1]],this.initCommands=[],this.keepAliveCommandRaw=[85,23,1,1],this.keepAliveCommand=new Int8Array(this.keepAliveCommandRaw.length),this.startCommandRaw=[85,10,1,1],this.startCommand=new Int8Array(this.startCommandRaw.length),this.setinclineCommandRaw=[85,17,1,15],this.setinclineCommand=new Int8Array(this.setinclineCommandRaw.length),this.resetCommandRaw=[85,10,1,2],this.resetCommand=new Int8Array(this.resetCommandRaw.length),this.setUserDataCommandRaw=[85,1,6,35,0,250,0,74,0],this.setUserDataCommand=new Int8Array(this.setUserDataCommandRaw.length),this.setActionModeCommandRaw=[85,21,1,0],this.setActionModeCommand=new Int8Array(this.setActionModeCommandRaw.length),this.queryPulseTypeCommandRaw=[85,7,1,-1],this.queryPulseTypeCommand=new Int8Array(this.queryPulseTypeCommandRaw.length)}listen(){this.listening||(this.listening=!0,this.initializeDevice().catch(console.error))}async initializeDevice(){this.initializeCommands(),this.readLoop().catch(console.error);for(let t of this.initCommands)await this.writeToStream(t);await a(1e3),await this.writeToStream(this.keepAliveCommand),await a(5e3),await this.writeToStream(this.resetCommand),await a(500),await this.writeToStream(this.setUserDataCommand),await a(500),await this.writeToStream(this.setActionModeCommand),await a(500),await this.writeToStream(this.setinclineCommand),await a(500),await this.writeToStream(this.startCommand),await a(500),await this.writeToStream(this.queryPulseTypeCommand),await a(1e3),this.maintainKeepAlive().catch(console.error)}initializeCommands(){for(let t of this.initCommandsRaw){let e=new Int8Array(t.length);t.forEach((t,n)=>{e[n]=t}),this.initCommands.push(e)}this.initCommandsRaw=null,this.keepAliveCommandRaw.forEach((t,e)=>{this.keepAliveCommand[e]=t}),this.keepAliveCommandRaw=null,this.startCommandRaw.forEach((t,e)=>{this.startCommand[e]=t}),this.startCommandRaw=null,this.setinclineCommandRaw.forEach((t,e)=>{this.setinclineCommand[e]=t}),this.setinclineCommandRaw=null,this.resetCommandRaw.forEach((t,e)=>{this.resetCommand[e]=t}),this.resetCommandRaw=null,this.setUserDataCommandRaw.forEach((t,e)=>{this.setUserDataCommand[e]=t}),this.setUserDataCommandRaw=null,this.setActionModeCommandRaw.forEach((t,e)=>{this.setActionModeCommand[e]=t}),this.setActionModeCommandRaw=null,this.queryPulseTypeCommandRaw.forEach((t,e)=>{this.queryPulseTypeCommand[e]=t}),this.queryPulseTypeCommandRaw=null}async writeToStream(...t){const e=this.outputStream.getWriter();for(let n of t)await e.write(n);e.releaseLock()}async maintainKeepAlive(){for(;;)await a(5e3),await this.writeToStream(this.keepAliveCommand)}async readLoop(){for(;;){const{value:t,done:e}=await this.reader.read();if(t){let e=t.length,n="";for(let e of t)e=e.toString(16),1===e.length&&(e="0"+e),n+=e;let i=n.indexOf("550d");if(-1!==i){let n=i/2;if(e>=n+16){n+=3;let e=t.buffer.slice(n);const i=new Int8Array(e),r=(i[8],255&i[10]),s=(new DataView(e.slice(4,6)).getInt16(0,!1),new DataView(e.slice(0,2)).getInt16(0,!1),new DataView(e.slice(11,13)).getInt16(0,!1));this.dispatch("power",s),this.dispatch("cadence",r),this.clearValueOnTimeout(["power","cadence"])}}}if(e){this.reader.releaseLock();break}}}}var hi={};try{!function(t,e){if("+"!==new t("q=%2B").get("q")||"+"!==new t({q:"+"}).get("q")||"+"!==new t([["q","+"]]).get("q")||"q=%0A"!==new t("q=\n").toString()||"q=+%26"!==new t({q:" &"}).toString()||"q=%25zx"!==new t({q:"%zx"}).toString())throw t;hi.URLSearchParams=t}(URLSearchParams)}catch(t){!function(t,e,n){var i=t.create,r=t.defineProperty,s=/[!'\(\)~]|%20|%00/g,o=/%(?![0-9a-fA-F]{2})/g,a=/\+/g,l={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"},c={append:function(t,e){p(this._ungap,t,e)},delete:function(t){delete this._ungap[t]},get:function(t){return this.has(t)?this._ungap[t][0]:null},getAll:function(t){return this.has(t)?this._ungap[t].slice(0):[]},has:function(t){return t in this._ungap},set:function(t,n){this._ungap[t]=[e(n)]},forEach:function(t,n){var i=this;for(var r in i._ungap)i._ungap[r].forEach(s,r);function s(s){t.call(n,s,e(r),i)}},toJSON:function(){return{}},toString:function(){var t=[];for(var e in this._ungap)for(var n=m(e),i=0,r=this._ungap[e];i<r.length;i++)t.push(n+"="+m(r[i]));return t.join("&")}};for(var u in c)r(h.prototype,u,{configurable:!0,writable:!0,value:c[u]});function h(t){var e=i(null);switch(r(this,"_ungap",{value:e}),!0){case!t:break;case"string"==typeof t:"?"===t.charAt(0)&&(t=t.slice(1));for(var s=t.split("&"),o=0,a=s.length;o<a;o++){var l=(c=s[o]).indexOf("=");-1<l?p(e,f(c.slice(0,l)),f(c.slice(l+1))):c.length&&p(e,f(c),"")}break;case n(t):for(o=0,a=t.length;o<a;o++){var c;p(e,(c=t[o])[0],c[1])}break;case"forEach"in t:t.forEach(d,e);break;default:for(var u in t)p(e,u,t[u])}}function d(t,e){p(this,e,t)}function p(t,e,i){var r=n(i)?i.join(","):i;e in t?t[e].push(r):t[e]=[r]}function f(t){return decodeURIComponent(t.replace(o,"%25").replace(a," "))}function m(t){return encodeURIComponent(t).replace(s,g)}function g(t){return l[t]}hi.URLSearchParams=h}(Object,String,Array.isArray)}!function(t){var e=!1;try{e=!!Symbol.iterator}catch(t){}function n(t,n){var i=[];return t.forEach(n,i),e?i[Symbol.iterator]():{next:function(){var t=i.shift();return{done:void 0===t,value:t}}}}"forEach"in t||(t.forEach=function(t,e){var n=this,i=Object.create(null);this.toString().replace(/=[\s\S]*?(?:&|$)/g,"=").split("=").forEach((function(r){r.length&&!(r in i)&&(i[r]=n.getAll(r)).forEach((function(i){t.call(e,i,r,n)}))}))}),"keys"in t||(t.keys=function(){return n(this,(function(t,e){this.push(e)}))}),"values"in t||(t.values=function(){return n(this,(function(t,e){this.push(t)}))}),"entries"in t||(t.entries=function(){return n(this,(function(t,e){this.push([e,t])}))}),e&&!(Symbol.iterator in t)&&(t[Symbol.iterator]=t.entries),"sort"in t||(t.sort=function(){for(var t,e,n,i=this.entries(),r=i.next(),s=r.done,o=[],a=Object.create(null);!s;)e=(n=r.value)[0],o.push(e),e in a||(a[e]=[]),a[e].push(n[1]),s=(r=i.next()).done;for(o.sort(),t=0;t<o.length;t++)this.delete(o[t]);for(t=0;t<o.length;t++)e=o[t],this.append(e,a[e].shift())}),function(e){var n=e.defineProperty,i=e.getOwnPropertyDescriptor,r=function(e){var n=e.append;e.append=t.append,URLSearchParams.call(e,e._usp.search.slice(1)),e.append=n},s=function(t,e){if(!(t instanceof e))throw new TypeError("'searchParams' accessed on an object that does not implement interface "+e.name)},o=function(o){var a,l,c=o.prototype,u=i(c,"searchParams"),h=i(c,"href"),d=i(c,"search");!u&&d&&d.set&&(l=function(e){function i(n,i){t.append.call(this,n,i),n=this.toString(),e.set.call(this._usp,n?"?"+n:"")}function r(n){t.delete.call(this,n),n=this.toString(),e.set.call(this._usp,n?"?"+n:"")}function s(n,i){t.set.call(this,n,i),n=this.toString(),e.set.call(this._usp,n?"?"+n:"")}return function(t,e){return t.append=i,t.delete=r,t.set=s,n(t,"_usp",{configurable:!0,writable:!0,value:e})}}(d),a=function(t,e){return n(t,"_searchParams",{configurable:!0,writable:!0,value:l(e,t)}),e},e.defineProperties(c,{href:{get:function(){return h.get.call(this)},set:function(t){var e=this._searchParams;h.set.call(this,t),e&&r(e)}},search:{get:function(){return d.get.call(this)},set:function(t){var e=this._searchParams;d.set.call(this,t),e&&r(e)}},searchParams:{get:function(){return s(this,o),this._searchParams||a(this,new URLSearchParams(this.search.slice(1)))},set:function(t){s(this,o),a(this,t)}}}))};try{o(HTMLAnchorElement),/^function|object$/.test(typeof URL)&&URL.prototype&&o(URL)}catch(t){}}(Object)}(hi.URLSearchParams.prototype);const di=hi.URLSearchParams;var pi={fullscreenEnabled:0,fullscreenElement:1,requestFullscreen:2,exitFullscreen:3,fullscreenchange:4,fullscreenerror:5,fullscreen:6},fi=["webkitFullscreenEnabled","webkitFullscreenElement","webkitRequestFullscreen","webkitExitFullscreen","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],mi=["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],gi=["msFullscreenEnabled","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"],vi="undefined"!=typeof window&&void 0!==window.document?window.document:{},yi="fullscreenEnabled"in vi&&Object.keys(pi)||fi[0]in vi&&fi||mi[0]in vi&&mi||gi[0]in vi&&gi||[];const _i={requestFullscreen:function(t){return t[yi[pi.requestFullscreen]]()},requestFullscreenFunction:function(t){return t[yi[pi.requestFullscreen]]},get exitFullscreen(){return vi[yi[pi.exitFullscreen]].bind(vi)},get fullscreenPseudoClass(){return":"+yi[pi.fullscreen]},addEventListener:function(t,e,n){return vi.addEventListener(yi[pi[t]],e,n)},removeEventListener:function(t,e,n){return vi.removeEventListener(yi[pi[t]],e,n)},get fullscreenEnabled(){return Boolean(vi[yi[pi.fullscreenEnabled]])},set fullscreenEnabled(t){},get fullscreenElement(){return vi[yi[pi.fullscreenElement]]},set fullscreenElement(t){},get onfullscreenchange(){return vi[("on"+yi[pi.fullscreenchange]).toLowerCase()]},set onfullscreenchange(t){return vi[("on"+yi[pi.fullscreenchange]).toLowerCase()]=t},get onfullscreenerror(){return vi[("on"+yi[pi.fullscreenerror]).toLowerCase()]},set onfullscreenerror(t){return vi[("on"+yi[pi.fullscreenerror]).toLowerCase()]=t}};async function wi(){let t=new URL(window.location),e=new di(t.search);if(e.get("state")&&e.get("code")){let t=u(),n=new FormData;n.set("client_id",o.STRAVA_CLIENT_ID),n.set("client_secret",o.STRAVA_CLIENT_SECRET),n.set("code",e.get("code")),n.set("grant_type","authorization_code");let i=await fetch("https://www.strava.com/oauth/token",{method:"POST",body:n});if(i.ok){let n=await i.json();t.access_token=n.access_token,t.refresh_token=n.refresh_token,h(t);let r=window.location.pathname;return"true"===e.get("useant")?r+="?useant=true":"true"===e.get("useserial")&&(r+="?useserial=true"),void window.location.assign(r)}{let t=await i.json(),e=t.message,n=JSON.stringify(t.errors),r=document.getElementById("strava-error-message");r.innerHTML=`Strava Connect Error: ${e} - ${n}`,r.style.display="block"}}else if(e.get("state")&&e.get("error")){let t=document.getElementById("strava-error-message");t.innerHTML="Strava Connect Error: "+e.get("error"),t.style.display="block"}let n=window.location.protocol,i="true"===e.get("useant"),r="true"===e.get("useserial");null!=o.STRAVA_CLIENT_ID&&""!==o.STRAVA_CLIENT_ID||(document.getElementById("container-strava").style.display="none"),c()&&(document.getElementById("strava-btn-connect").style.display="none",document.getElementById("strava-btn-connected").style.display="block",document.getElementById("strava-clear").style.display="block");let s=On.container("route-progress"),a=document.getElementById("continue-previous");for(let t of s)try{let e=On.get(t);var l=document.createElement("option");let n=new Date;n.setTime(e.id),l.innerHTML=n.toLocaleDateString()+" "+n.toLocaleTimeString()+" - "+e.routeName,l.setAttribute("value",t),a.add(l)}catch(t){localStorage.clear(),location.reload();break}let d,p=[["virtual",new ii],["cycleopsmagnetopowercurve",new ri]],f=[],m=[],g=document.getElementById("gpx-file-upload"),v=document.getElementById("display-unit"),y=document.getElementById("rider-weight"),_=document.getElementById("begin-session"),w=document.getElementById("btn-bluetooth-device-txt"),b=document.getElementById("btn-ant-device-txt"),S=document.getElementById("btn-serial-device-txt"),E=document.getElementById("strava-btn-connect"),x=document.getElementById("strava-btn-clear"),C=document.getElementById("btn-bluetooth-device"),M=document.getElementById("btn-ant-device"),k=document.getElementById("btn-serial-device"),T=document.getElementById("power-meter"),I=document.getElementById("hr-meter"),N=document.getElementById("cadence-meter"),A=document.getElementById("menuopen-btn"),R=document.getElementById("btn-fullscreen"),L=document.getElementById("bluetooth-device-container"),O=document.getElementById("ant-device-container"),D=document.getElementById("serial-device-container"),P=document.getElementById("ant-ws-url"),U=t=>{T.options.length=0;for(let[n,i]of p){(e=document.createElement("option")).innerHTML=i.name,e.setAttribute("value",i.id),i.id===t.id&&e.setAttribute("selected","true"),T.add(e)}"virtual"===T.value&&p.length>1&&T.options[0].setAttribute("selected","true"),I.options.length=0;for(let[n,i]of f){(e=document.createElement("option")).innerHTML=i.name,e.setAttribute("value",i.id),i.id===t.id&&e.setAttribute("selected","true"),I.options.add(e)}0===I.options.length&&((e=document.createElement("option")).innerHTML="Disabled",e.setAttribute("value",""),I.options.add(e));N.options.length=0;for(let[n,i]of m){var e;(e=document.createElement("option")).innerHTML=i.name,e.setAttribute("value",i.id),i.id===t.id&&e.setAttribute("selected","true"),N.options.add(e)}0===N.options.length&&((e=document.createElement("option")).innerHTML="Disabled",e.setAttribute("value",""),N.options.add(e))};for(let t of document.querySelectorAll("#route-nav a"))t.onclick=t=>{t.preventDefault();let e=t.target.getAttribute("href");for(let t of document.querySelectorAll(".nav-link"))t.classList.remove("active");t.target.classList.add("active");for(let t of document.querySelectorAll(".tab-pane"))t.classList.remove("active");document.querySelector(e).classList.add("active")};if(v.onchange=t=>{"imperial"===v.value?(document.getElementById("rider-weight-label").innerHTML="Rider Weight (lbs)",document.getElementById("rider-weight").setAttribute("placeholder",185)):(document.getElementById("rider-weight-label").innerHTML="Rider Weight (kg)",document.getElementById("rider-weight").setAttribute("placeholder",85))},A.onclick=t=>{t.preventDefault(),"none"===document.getElementById("ui-finalize-container").style.display?d.showFinalizeUI("Complete Ride"):document.getElementById("ui-finalize-container").style.display="none"},R.onclick=t=>{t.preventDefault(),null!==_i.fullscreenElement?_i.exitFullscreen():_i.requestFullscreen(document.body)},E.onclick=t=>{t.preventDefault();let n=window.location.protocol+"//"+window.location.host+window.location.pathname;"true"===e.get("useant")?n+="?useant=true":"true"===e.get("useserial")&&(n+="?useserial=true"),window.location.assign("https://www.strava.com/oauth/authorize?client_id="+o.STRAVA_CLIENT_ID+"&response_type=code&redirect_uri="+encodeURIComponent(n)+"&scope=activity%3Awrite&state=strava")},x.onclick=t=>{t.preventDefault(),localStorage.removeItem("strava-oauth"+o.STRAVA_CLIENT_ID),document.getElementById("strava-btn-connect").style.display="block",document.getElementById("strava-btn-connected").style.display="none",document.getElementById("strava-clear").style.display="none"},C.onclick=t=>{if(t.preventDefault(),"undefined"==typeof navigator||!("bluetooth"in navigator))return document.getElementById("btn-bluetooth-device").style.display="none",void(document.getElementById("btn-bluetooth-device-warning").style.display="block");C.classList.contains("disabled")||(C.classList.add("disabled"),w.innerHTML="Connecting ...",async function(){let t=await navigator.bluetooth.requestDevice({filters:[{services:[6157]},{services:[6168]},{services:[6166]}]}),e=await t.gatt.connect(),n=void 0;if(!p.find(e=>e[0]===t.id)){let i=void 0;try{i=await e.getPrimaryService(6168)}catch(t){}if(i){let r=await i.getCharacteristic(10851),s=new Yn,o=await function(t){return new Promise((function(e,n){let i=!1,r=n=>{t.removeEventListener("characteristicvaluechanged",r),t.stopNotifications(),i||(i=!0,e(n.target.value))};t.addEventListener("characteristicvaluechanged",r),t.startNotifications()}))}(r);"cumulative_crank_revolutions"in s.getData(o)?(n=new Qn(t,e,i,r),p.push([n.id,n]),m.push([n.id,n])):(n=new ti(t,e,i,r),p.push([n.id,n]))}}if(!m.find(e=>e[0]===t.id)){let i=void 0;try{i=await e.getPrimaryService(6166)}catch(t){}if(i){let r=await i.getCharacteristic(10843);n=new ei(t,e,i,r),m.push([n.id,n])}}if(!f.find(e=>e[0]===t.id)){let i=void 0;try{i=await e.getPrimaryService(6157)}catch(t){}if(i){let r=await i.getCharacteristic(10807);n=new ni(t,e,i,r),f.push([n.id,n])}}n&&U(n),C.classList.remove("disabled"),w.innerHTML="Connect"}().catch(t=>{C.classList.remove("disabled"),w.innerHTML="Connect",console.log("Error: ",t)}))},M.onclick=t=>{if(t.preventDefault(),M.classList.contains("disabled"))return;M.classList.add("disabled"),b.innerHTML="Scanning ...";let e=document.getElementById("btn-ant-device-error");P.style.display="none",e.style.display="none",async function(){let t=P.value;localStorage.setItem("ant-ws-url",t),t||(t="https:"===n?"https://localhost:4430/":"http://localhost:8000/");const i=new ci(t);i.addListener("bike_power",t=>{p.push([t.id,t]),U(t)}),i.addListener("speed_cadence",t=>{m.push([t.id,t]),U(t)}),i.addListener("hr",t=>{f.push([t.id,t]),U(t)}),i.addListener("namechange",t=>{U(t)}),i.addListener("error",t=>{P.style.display="inline";let r="";"https:"===n&&(r="<br/>You may need to allow a self signed cert for "+i.url+' by clicking <a href="'+i.url+'" target="_blank">here</a>'),e.innerHTML="<br/> Could not connect to the ANT-WS server located at: "+i.url+r,e.style.display="inline",M.classList.remove("disabled"),b.innerHTML="Scan"}),i.scan()}().catch(t=>{M.classList.remove("disabled"),b.innerHTML="Scan",console.log("Error: ",t)})},k.onclick=t=>{if(t.preventDefault(),k.classList.contains("disabled"))return;k.classList.add("disabled"),S.innerHTML="Connecting ...";let e=document.getElementById("btn-serial-device-error");e.style.display="none",async function(){let t=await navigator.serial.requestPort();await t.open({baudRate:9600});let e=new ui(t);p.push([e.id,e]),m.push([e.id,e]),U(e),k.classList.remove("disabled"),S.innerHTML="Connect"}().catch(t=>{k.classList.remove("disabled"),S.innerHTML="Connect",console.log("Error: ",t),e.innerHTML="<br/> "+t,e.style.display="inline"})},_.onclick=t=>{if(t.preventDefault(),(g.value||a.value)&&y.value){if(_.classList.contains("disabled"))return;_.classList.add("disabled"),async function(){let t,e=y.value,n=v.value,i=I.value;i&&(t=f.find(t=>t[0]===i)[1],t.listen());let r,s=N.value;s&&(r=m.find(t=>t[0]===s)[1],r.listen());let o=T.value,l=p.find(t=>t[0]===o)[1];if(l.listen({heartMeter:t,cadenceMeter:r}),localStorage.setItem("form-weight",e),localStorage.setItem("form-unit",n),a.value){let e=On.get(a.value);d=qn.fromJSON(e),d.powerMeter=l,d.heartMeter=t,d.cadenceMeter=r,On.unshift("route-progress",d.cacheName())}else{let i=await(c=g.files[0],new Promise((function(t,e){let n=new FileReader;n.onload=e=>{t(e.target.result)},n.onerror=t=>{e(t.target.error)},n.readAsText(c,"UTF-8")}))),s=new Bn(i),o=await s.create();d=new qn({points:o,riderWeight:e,unit:n,powerMeter:l,heartMeter:t,cadenceMeter:r}),On.add("route-progress",d.cacheName(),d)}var c;qn.transitionUI(),await d.init(),d.updateUI(),await d.updatePosition(),On.remove("route-progress",d.cacheName()),d.showFinalizeUI("Ride Finished")}().catch(t=>{console.log("Error: ",t)})}else{let t="";g.value||a.value?y.value||(t="Please enter the riders weight."):t="Please select a GPX file.";let e=document.getElementById("messages");e.innerHTML=t,e.style.display="block",window.scrollTo(0,0)}},localStorage.getItem("form-weight")&&(y.value=localStorage.getItem("form-weight")),localStorage.getItem("form-unit")&&(v.value=localStorage.getItem("form-unit"),v.onchange()),localStorage.getItem("ant-ws-url")&&(P.value=localStorage.getItem("ant-ws-url")),i&&(L.style.display="none",O.style.display="block",D.style.display="none"),r&&(L.style.display="none",O.style.display="none",D.style.display="block"),"serial"in navigator)for(let t of document.querySelectorAll(".serial-switch-link"))t.style.display="block"}document.addEventListener("DOMContentLoaded",()=>{wi().catch(console.error)})})()})();
//# sourceMappingURL=bundle.js.map